(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1442],{9845:function(e,t,a){Promise.resolve().then(a.bind(a,3053))},3053:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return o}});var l=a(57437),r=a(84603),s=a(27648),n=a(2265),i=a(40257);let d=i.env.NEXT_PUBLIC_API_BASE||i.env.NEXT_PUBLIC_API_URL||"http://localhost:4000";function o(){let{user:e}=(0,r.a)(),[t,a]=(0,n.useState)([]),[i,o]=(0,n.useState)(""),[v,b]=(0,n.useState)("new"),[f,g]=(0,n.useState)(!0),[w,N]=(0,n.useState)(null);async function y(){g(!0),N(null);try{let t=await k();a(t),function(e,t){if(e&&t)try{var a;let l=JSON.parse(null!==(a=localStorage.getItem("ark_user_apps"))&&void 0!==a?a:"{}");l[e]=t,localStorage.setItem("ark_user_apps",JSON.stringify(l))}catch(e){}}(null==e?void 0:e.email,t)}catch(t){N("string"==typeof t?t:(null==t?void 0:t.message)||(t&&"object"==typeof t?JSON.stringify(t):"Gagal memuat data dari server")),a(function(e){if(!e)return[];try{var t;let a=JSON.parse(null!==(t=localStorage.getItem("ark_user_apps"))&&void 0!==t?t:"{}");return(Array.isArray(a[e])?a[e]:[]).map(e=>{var t,a,l,r;return{jobId:e.jobId,title:null!==(t=e.title)&&void 0!==t?t:"Job ".concat(e.jobId),location:null!==(a=e.location)&&void 0!==a?a:"-",appliedAt:p(null!==(r=null!==(l=e.appliedAt)&&void 0!==l?l:e.date)&&void 0!==r?r:new Date),status:S(e.status)}}).filter(e=>!!e.jobId)}catch(e){return[]}}(null==e?void 0:e.email))}finally{g(!1)}}async function k(){let e=(d||"").replace(/\/+$/,""),t=await fetch("".concat(e,"/api/users/applications"),{credentials:"include",headers:{"Content-Type":"application/json"}});if(!t.ok){let e="";try{let a=await t.json();e=(null==a?void 0:a.error)||"HTTP ".concat(t.status)}catch(a){try{e=await t.text()}catch(a){e="HTTP ".concat(t.status)}}throw Error(e)}let a=await t.json().catch(()=>({})),l=Array.isArray(null==a?void 0:a.rows)?a.rows:Array.isArray(null==a?void 0:a.data)?a.data:null;if(!Array.isArray(l))throw Error("Format API tidak sesuai: rows tidak ditemukan");return l.map(e=>{var t,a,l,r,s,n,i,d,o;return{jobId:null!==(a=null!==(t=e.jobId)&&void 0!==t?t:e.id)&&void 0!==a?a:"",title:null!==(n=null!==(l=e.title)&&void 0!==l?l:e.jobTitle)&&void 0!==n?n:"Job ".concat(null!==(s=null!==(r=e.jobId)&&void 0!==r?r:e.id)&&void 0!==s?s:""),location:null!==(i=e.location)&&void 0!==i?i:"-",appliedAt:p(null!==(o=null!==(d=e.appliedAt)&&void 0!==d?d:e.createdAt)&&void 0!==o?o:new Date),status:S(e.status)}})}function S(e){let t=String(e||"").toLowerCase();return"submitted"===t||"review"===t||"shortlist"===t||"rejected"===t||"hired"===t?t:"review"}(0,n.useEffect)(()=>{null===e&&(window.location.href="/auth/signin")},[e]),(0,n.useEffect)(()=>{(null==e?void 0:e.email)&&y()},[null==e?void 0:e.email]);let A=(0,n.useMemo)(()=>{let e=i.trim().toLowerCase(),a=e?t.filter(t=>t.title.toLowerCase().includes(e)||t.location.toLowerCase().includes(e)||String(t.jobId).toLowerCase().includes(e)):t.slice();return a.sort((e,t)=>{let a=new Date(e.appliedAt).getTime(),l=new Date(t.appliedAt).getTime();return"new"===v?l-a:a-l}),a},[t,i,v]),I="string"==typeof w?w:w?JSON.stringify(w):null;return(0,l.jsx)("div",{className:"min-h-screen bg-neutral-50 py-10",children:(0,l.jsxs)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[I&&(0,l.jsx)("div",{className:"mb-4 rounded-2xl border border-amber-300 bg-amber-50 p-4 text-amber-900",children:(0,l.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-semibold",children:"Perhatian"}),(0,l.jsx)("div",{className:"text-sm break-words",children:I})]}),(0,l.jsx)("button",{onClick:y,className:"rounded-xl bg-amber-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-amber-700 active:translate-y-[1px]",children:"Refresh"})]})}),(0,l.jsxs)("div",{className:"mb-8 overflow-hidden rounded-3xl border border-neutral-200 bg-gradient-to-br from-neutral-900 to-neutral-700 p-6 text-white shadow-sm",children:[(0,l.jsxs)("div",{className:"flex flex-col items-start justify-between gap-4 md:flex-row md:items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs/5 opacity-70",children:"Lamaran Saya"}),(0,l.jsx)("h1",{className:"mt-1 text-2xl font-semibold tracking-tight",children:"My Applications"}),(0,l.jsx)("p",{className:"mt-1 text-sm opacity-80",children:"Riwayat lamaran kerja yang kamu kirim melalui ArkWork."})]}),(0,l.jsx)("div",{className:"flex items-center gap-2",children:(0,l.jsxs)(s.default,{href:"/jobs",className:"inline-flex items-center gap-2 rounded-xl bg-white/10 px-4 py-2 text-sm font-medium text-white ring-1 ring-white/15 hover:bg-white/15 active:translate-y-[1px]",children:[(0,l.jsx)("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",children:(0,l.jsx)("path",{d:"M4 7h16M4 12h16M4 17h10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),"Cari Lowongan"]})})]}),(0,l.jsxs)("div",{className:"mt-5 grid gap-3 sm:grid-cols-3",children:[(0,l.jsx)(c,{label:"Total Lamaran",value:t.length}),(0,l.jsx)(c,{label:"Dalam Peninjauan",value:t.filter(e=>"review"===e.status||"submitted"===e.status).length}),(0,l.jsx)(c,{label:"Masuk Shortlist",value:t.filter(e=>"shortlist"===e.status).length})]})]}),(0,l.jsxs)("div",{className:"mb-4 flex flex-col items-stretch gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,l.jsxs)("div",{className:"relative w-full sm:max-w-xs",children:[(0,l.jsx)("input",{value:i,onChange:e=>o(e.target.value),placeholder:"Cari posisi / lokasi / ID…",className:"w-full rounded-2xl border border-neutral-300 bg-white px-4 py-2.5 text-sm outline-none transition focus:border-neutral-900"}),i&&(0,l.jsx)("button",{onClick:()=>o(""),className:"absolute right-2 top-1/2 -translate-y-1/2 rounded-md px-2 py-1 text-xs text-neutral-600 hover:bg-neutral-100",children:"Hapus"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-xs text-neutral-500",children:"Urut:"}),(0,l.jsxs)("div",{className:"inline-flex overflow-hidden rounded-xl border border-neutral-300 bg-white p-0.5",children:[(0,l.jsx)("button",{onClick:()=>b("new"),className:"rounded-lg px-3 py-1.5 text-sm ".concat("new"===v?"bg-neutral-900 text-white":"text-neutral-700 hover:bg-neutral-50"),children:"Terbaru"}),(0,l.jsx)("button",{onClick:()=>b("old"),className:"rounded-lg px-3 py-1.5 text-sm ".concat("old"===v?"bg-neutral-900 text-white":"text-neutral-700 hover:bg-neutral-50"),children:"Terlama"})]})]})]}),(0,l.jsx)("div",{className:"overflow-hidden rounded-3xl border border-neutral-200 bg-white shadow-sm",children:f?(0,l.jsx)("div",{className:"px-6 py-16 text-center text-neutral-600",children:"Memuat…"}):0===A.length?(0,l.jsx)(u,{}):(0,l.jsxs)("div",{className:"overflow-x-auto",children:[(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{className:"bg-neutral-50 text-neutral-600",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)(x,{className:"w-[40%]",children:"Position"}),(0,l.jsx)(x,{children:"Location"}),(0,l.jsx)(x,{children:"Applied On"}),(0,l.jsx)(x,{children:"Status"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-neutral-200",children:A.map((e,t)=>(0,l.jsxs)("tr",{className:"hover:bg-neutral-50/60",children:[(0,l.jsx)(m,{children:(0,l.jsx)("div",{className:"max-w-[540px] truncate font-medium text-neutral-900",children:e.title})}),(0,l.jsx)(m,{className:"text-neutral-700",children:e.location}),(0,l.jsx)(m,{className:"text-neutral-700",children:j(e.appliedAt)}),(0,l.jsx)(m,{children:(0,l.jsx)(h,{status:e.status})})]},e.jobId))})]}),(0,l.jsx)("div",{className:"grid gap-3 p-3 sm:hidden",children:A.map((e,t)=>(0,l.jsxs)("div",{className:"rounded-2xl border border-neutral-200 p-4",children:[(0,l.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,l.jsx)("div",{children:(0,l.jsx)("div",{className:"max-w-[240px] truncate font-medium text-neutral-900",children:e.title})}),(0,l.jsx)(h,{status:e.status})]}),(0,l.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-2 text-xs text-neutral-600",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-neutral-400",children:"Location"}),(0,l.jsx)("div",{className:"mt-0.5",children:e.location})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-neutral-400",children:"Applied On"}),(0,l.jsx)("div",{className:"mt-0.5",children:j(e.appliedAt)})]})]})]},"m-".concat(e.jobId)))})]})}),(0,l.jsx)("p",{className:"mt-6 text-center text-xs text-neutral-500",children:"Data lamaran disimpan lokal untuk demo bila server tidak tersedia."})]})})}function c(e){let{label:t,value:a}=e;return(0,l.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[(0,l.jsx)("div",{className:"text-xs text-white/70",children:t}),(0,l.jsx)("div",{className:"mt-1 text-2xl font-semibold tracking-tight",children:a})]})}function u(){return(0,l.jsx)("div",{className:"grid place-items-center px-6 py-16 text-center",children:(0,l.jsxs)("div",{className:"mx-auto max-w-md",children:[(0,l.jsx)("div",{className:"mx-auto grid h-14 w-14 place-items-center rounded-2xl bg-neutral-100",children:(0,l.jsx)("svg",{className:"h-6 w-6 text-neutral-500",viewBox:"0 0 24 24",fill:"none",children:(0,l.jsx)("path",{d:"M4 7h16M4 12h16M4 17h10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}),(0,l.jsx)("h3",{className:"mt-4 text-lg font-semibold text-neutral-900",children:"Belum ada lamaran"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-neutral-600",children:"Kamu belum melamar pekerjaan. Mulai eksplorasi lowongan sekarang."}),(0,l.jsx)(s.default,{href:"/jobs",className:"mt-4 inline-flex items-center gap-2 rounded-xl bg-neutral-900 px-4 py-2 text-sm font-medium text-white hover:bg-neutral-800 active:translate-y-[1px]",children:"Telusuri Lowongan"})]})})}function x(e){let{children:t,className:a=""}=e;return(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ".concat(a),children:t})}function m(e){let{children:t,className:a=""}=e;return(0,l.jsx)("td",{className:"whitespace-nowrap px-6 py-4 ".concat(a),children:t})}function h(e){var t;let{status:a}=e,r={submitted:{text:"Submitted",cls:"bg-blue-100 text-blue-700"},review:{text:"Under Review",cls:"bg-amber-100 text-amber-800"},shortlist:{text:"Shortlisted",cls:"bg-emerald-100 text-emerald-700"},rejected:{text:"Rejected",cls:"bg-rose-100 text-rose-700"},hired:{text:"Hired",cls:"bg-indigo-100 text-indigo-700"}},{text:s,cls:n}=null!==(t=r[a])&&void 0!==t?t:r.review;return(0,l.jsx)("span",{className:"inline-flex rounded-full px-2.5 py-1 text-xs font-semibold ".concat(n),children:s})}function p(e){try{if("string"==typeof e)return new Date(e).toISOString();if(e instanceof Date)return e.toISOString();return new Date(e).toISOString()}catch(e){return new Date().toISOString()}}function j(e){let t=new Date(e);if(Number.isNaN(t.getTime()))return String(e);let a=Date.now()-t.getTime(),l=Math.floor(a/864e5);if(l<1){let e=Math.floor(a/36e5);return e<1?"".concat(Math.max(1,Math.floor(a/6e4))," menit lalu"):"".concat(e," jam lalu")}return l<30?"".concat(l," hari lalu"):new Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"2-digit"}).format(t)}}},function(e){e.O(0,[6933,4603,2971,2117,1744],function(){return e(e.s=9845)}),_N_E=e.O()}]);