(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7975],{76728:function(e,a,t){Promise.resolve().then(t.bind(t,8483))},99376:function(e,a,t){"use strict";var s=t(35475);t.o(s,"usePathname")&&t.d(a,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(a,{useSearchParams:function(){return s.useSearchParams}})},8483:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var s=t(57437),r=t(2265),l=t(99376),n=t(27648),c=t(40257);let o=c.env.NEXT_PUBLIC_API_BASE||c.env.NEXT_PUBLIC_API_URL||"http://localhost:4000",i=e=>"".concat(o.replace(/\/+$/,"")).concat(e),d={OPEN:"baru",UNDER_REVIEW:"diproses",ACTION_TAKEN:"selesai",DISMISSED:"abaikan"},u={baru:"OPEN",diproses:"UNDER_REVIEW",selesai:"ACTION_TAKEN",abaikan:"DISMISSED"};function h(){(0,l.useRouter)();let[e,a]=(0,r.useState)([]),[t,c]=(0,r.useState)(""),[o,h]=(0,r.useState)(!1),[m,x]=(0,r.useState)(null),p=async()=>{h(!0),x(null);try{let e;console.log("Fetching reports from: ".concat(i("/api/reports")));let t=await fetch(i("/api/reports"),{cache:"no-store",credentials:"include"});console.log("API Response Status: ".concat(t.status));try{e=await t.json(),console.log("Raw data received from API:",e)}catch(e){throw e}if(!t.ok||!(null==e?void 0:e.ok))throw Error((null==e?void 0:e.message)||"Failed to fetch: ".concat(t.status));let s=Array.isArray(null==e?void 0:e.data)?e.data:[];console.log("Processed data to be set in state:",s),a(s)}catch(e){console.error("[admin/reports] load() failed:",e),x(e.message||"Gagal memuat data laporan."),a([])}finally{h(!1)}};(0,r.useEffect)(()=>{p()},[]),(0,r.useEffect)(()=>{},[]);let g=(e,a)=>a?"".concat(e.replace(/\/+$/,""),"?focus=").concat(encodeURIComponent(String(a))):e,N=e=>{if(!e)return"/";let a=e.replace(/\/?\(protected\)\//g,"/").replace(/\/{2,}/g,"/");return a.startsWith("/")?a:"/"+a},f=e=>{if(e.targetUrl)return N(e.targetUrl);let a=e.targetSlug||e.targetId,t=e.targetType,s="";switch(t){case"JOB":s="/admin/employer-jobs";break;case"EMPLOYER":case"COMPANY":s="/admin/user-management/employers";break;case"USER":s="/admin/user-management/users";break;case"TENDER":s="/admin/tenders";break;default:return null}return a?g(N(s),a):null},j=(0,r.useMemo)(()=>{let a=Array.isArray(e)?e:[];if(!t.trim())return a;let s=t.toLowerCase();return a.filter(e=>[e.judul,e.perusahaan,e.reason,e.details,e.status].filter(e=>null!=e).some(e=>String(e).toLowerCase().includes(s)))},[e,t]),b=async(e,a)=>{},y=async e=>{},v=e=>"OPEN"===e?"bg-amber-100 text-amber-700":"UNDER_REVIEW"===e?"bg-blue-100 text-blue-700":"ACTION_TAKEN"===e?"bg-emerald-100 text-emerald-700":"bg-gray-100 text-gray-700",E=e=>{if(!e)return"—";try{let a=new Date(e);if(isNaN(a.getTime()))return"—";return a.toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"})}catch(e){return"—"}};return(0,s.jsxs)("main",{className:"mx-auto max-w-6xl space-y-4 p-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,s.jsx)("h1",{className:"text-xl font-semibold",children:"Admin \xb7 Laporan Masuk"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{value:t,onChange:e=>c(e.target.value),placeholder:"Cari laporan…",className:"w-full max-w-xs rounded-xl border px-3 py-2 focus:outline-none focus:ring"}),(0,s.jsx)("button",{onClick:p,disabled:o,className:"rounded-xl border px-3 py-2 hover:bg-gray-50 disabled:opacity-50",children:o?"Memuat…":"Muat ulang"})]})]}),m&&(0,s.jsxs)("div",{className:"rounded-md bg-red-50 p-4 text-sm text-red-700",role:"alert",children:[" ",(0,s.jsx)("strong",{children:"Error:"})," ",m," "]}),(0,s.jsx)("div",{className:"overflow-hidden rounded-2xl border bg-white",children:(0,s.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"p-3",children:"Judul"}),(0,s.jsx)("th",{className:"p-3",children:"Perusahaan"}),(0,s.jsx)("th",{className:"p-3",children:"Alasan"}),(0,s.jsx)("th",{className:"p-3",children:"Catatan"}),(0,s.jsx)("th",{className:"p-3",children:"Status"}),(0,s.jsx)("th",{className:"p-3",children:"Dibuat"}),(0,s.jsx)("th",{className:"p-3 text-right",children:"Aksi"})]})}),(0,s.jsxs)("tbody",{children:[o&&(0,s.jsxs)("tr",{children:[" ",(0,s.jsx)("td",{colSpan:7,className:"p-6 text-center text-gray-500",children:"Memuat data..."})," "]}),!o&&!m&&0===j.length&&(0,s.jsxs)("tr",{children:[" ",(0,s.jsxs)("td",{colSpan:7,className:"p-6 text-center text-gray-500",children:[" Belum ada data laporan ",t?"yang cocok.":"."," "]})," "]}),!o&&!m&&j.length>0&&j.map(e=>{var a,t,r,l;let c=String(e.status),o=d[c]||c,i=E(e.createdAt),h=f(e),m=null!==(a=e.judul)&&void 0!==a?a:null,x=null!==(t=e.perusahaan)&&void 0!==t?t:null,p=null!==(r=e.reason)&&void 0!==r?r:null,g=null!==(l=e.details)&&void 0!==l?l:null;return(0,s.jsxs)("tr",{className:"border-t align-top ".concat(h?"hover:bg-gray-50":""),children:[(0,s.jsx)("td",{className:"p-3 font-medium",children:h?(0,s.jsx)(n.default,{href:h,onClick:e=>e.stopPropagation(),className:"text-blue-600 hover:underline",prefetch:!1,children:m||"—"}):(0,s.jsx)("span",{children:m||"—"})}),(0,s.jsx)("td",{className:"p-3",children:x||"—"}),(0,s.jsx)("td",{className:"p-3",children:p||"—"}),(0,s.jsx)("td",{className:"p-3 max-w-[24rem]",children:(0,s.jsx)("div",{className:"line-clamp-3",children:g||"—"})}),(0,s.jsx)("td",{className:"p-3",children:(0,s.jsx)("span",{className:"rounded-full px-2 py-1 text-xs ".concat(v(c)),children:o})}),(0,s.jsx)("td",{className:"p-3 text-gray-500",children:i}),(0,s.jsx)("td",{className:"p-3",children:(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsxs)("select",{value:o,onChange:a=>b(e.id,u[a.target.value]),onClick:e=>e.stopPropagation(),className:"rounded-xl border px-2 py-1 text-xs",children:[(0,s.jsx)("option",{value:"baru",children:"baru"})," ",(0,s.jsx)("option",{value:"diproses",children:"diproses"})," ",(0,s.jsx)("option",{value:"selesai",children:"selesai"})," ",(0,s.jsx)("option",{value:"abaikan",children:"abaikan"})]}),(0,s.jsx)("button",{onClick:a=>{a.stopPropagation(),y(e.id)},className:"rounded-xl border px-2 py-1 text-xs text-red-600 hover:bg-red-50",children:" Hapus "})]})})]},e.id)})]})]})})]})}}},function(e){e.O(0,[6933,2971,2117,1744],function(){return e(e.s=76728)}),_N_E=e.O()}]);