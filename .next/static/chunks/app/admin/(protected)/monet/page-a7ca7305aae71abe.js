(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1995],{69939:function(e,t,a){Promise.resolve().then(a.bind(a,45050))},40257:function(e,t,a){"use strict";var s,n;e.exports=(null==(s=a.g.process)?void 0:s.env)&&"object"==typeof(null==(n=a.g.process)?void 0:n.env)?a.g.process:a(44227)},44227:function(e){!function(){var t={229:function(e){var t,a,s,n=e.exports={};function r(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function l(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(a){try{return t.call(null,e,0)}catch(a){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{a="function"==typeof clearTimeout?clearTimeout:i}catch(e){a=i}}();var o=[],c=!1,d=-1;function u(){c&&s&&(c=!1,s.length?o=s.concat(o):d=-1,o.length&&m())}function m(){if(!c){var e=l(u);c=!0;for(var t=o.length;t;){for(s=o,o=[];++d<t;)s&&s[d].run();d=-1,t=o.length}s=null,c=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===i||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function x(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];o.push(new h(e,t)),1!==o.length||c||l(m)},h.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=x,n.addListener=x,n.once=x,n.off=x,n.removeListener=x,n.removeAllListeners=x,n.emit=x,n.prependListener=x,n.prependOnceListener=x,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},a={};function s(e){var n=a[e];if(void 0!==n)return n.exports;var r=a[e]={exports:{}},i=!0;try{t[e](r,r.exports,s),i=!1}finally{i&&delete a[e]}return r.exports}s.ab="//";var n=s(229);e.exports=n}()},45050:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return o}});var s=a(57437),n=a(2265),r=a(71837);let i=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0}).format(e),l={id:"",slug:"",name:"",description:"",amount:"0",currency:"IDR",interval:"month",active:!0,priceId:"",trialDays:"0"};function o(){let[e,t]=(0,n.useState)([]),[a,o]=(0,n.useState)(!0),[c,d]=(0,n.useState)(null),[u,m]=(0,n.useState)(!1),[h,x]=(0,n.useState)(l),p=(0,n.useMemo)(()=>!!h.id,[h.id]);async function v(){o(!0),d(null);try{let e=await (0,r.hi)("/api/admin/plans");t(Array.isArray(e)?e:[])}catch(e){d((null==e?void 0:e.message)||"Gagal memuat paket")}finally{o(!1)}}async function f(){try{var e,t;d(null);let a={slug:(h.slug||"").trim().toLowerCase(),name:(h.name||"").trim(),description:(null===(e=h.description)||void 0===e?void 0:e.trim())||null,amount:Number(h.amount||0),currency:(h.currency||"IDR").trim(),interval:(h.interval||"month").trim(),active:!!h.active,priceId:(null===(t=h.priceId)||void 0===t?void 0:t.trim())||null,trialDays:Math.max(0,Number(h.trialDays||0))};if(!a.slug)throw Error("Slug wajib diisi");if(!a.name)throw Error("Nama paket wajib diisi");if(!Number.isFinite(a.amount)||a.amount<0)throw Error("Harga tidak valid");p?await (0,r.hi)("/api/admin/plans/".concat(h.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}):await (0,r.hi)("/api/admin/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),m(!1),await v()}catch(e){d((null==e?void 0:e.message)||"Gagal menyimpan paket")}}async function b(e){if(confirm('Hapus paket "'.concat(e.name,'"?')))try{await (0,r.hi)("/api/admin/plans/".concat(e.id),{method:"DELETE"}),await v()}catch(e){alert((null==e?void 0:e.message)||"Gagal menghapus")}}return(0,n.useEffect)(()=>{v()},[]),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-semibold text-slate-900",children:"Paket Monetisasi"}),(0,s.jsx)("p",{className:"text-sm text-slate-600",children:"Kelola paket, harga (boleh 0/Gratis), dan masa trial."})]}),(0,s.jsx)("button",{onClick:function(){x(l),m(!0)},className:"rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700",children:"+ Paket Baru"})]}),c&&(0,s.jsx)("div",{className:"mb-4 rounded-xl border border-rose-200 bg-rose-50 px-4 py-2 text-rose-700",children:c}),a?(0,s.jsx)("div",{className:"text-slate-500",children:"Loading…"}):0===e.length?(0,s.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-6 text-sm text-slate-600",children:["Belum ada paket. Klik ",(0,s.jsx)("b",{children:"+ Paket Baru"})," untuk menambahkan."]}):(0,s.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.map(e=>(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:e.name}),(0,s.jsxs)("div",{className:"text-xs text-slate-500",children:["/",e.interval]})]}),(0,s.jsx)("span",{className:"rounded-full px-2 py-0.5 text-xs ".concat(e.active?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600"),children:e.active?"Active":"Inactive"})]}),(0,s.jsx)("div",{className:"mt-2 text-lg font-bold",children:0===e.amount?"Gratis":i(e.amount)}),(0,s.jsxs)("div",{className:"mt-1 text-xs text-slate-500",children:["Trial: ",(0,s.jsxs)("b",{children:[e.trialDays," hari"]})]}),(0,s.jsx)("div",{className:"mt-2 text-sm text-slate-600 line-clamp-3",children:e.description||"—"}),(0,s.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>{var t,a,s,n,r,i,l,o;x({id:e.id,slug:null!==(t=e.slug)&&void 0!==t?t:"",name:null!==(a=e.name)&&void 0!==a?a:"",description:null!==(s=e.description)&&void 0!==s?s:"",amount:String(null!==(n=e.amount)&&void 0!==n?n:0),currency:null!==(r=e.currency)&&void 0!==r?r:"IDR",interval:null!==(i=e.interval)&&void 0!==i?i:"month",active:!!e.active,priceId:null!==(l=e.priceId)&&void 0!==l?l:"",trialDays:String(null!==(o=e.trialDays)&&void 0!==o?o:0)}),m(!0)},className:"rounded-lg border border-slate-300 px-3 py-1.5 text-sm hover:bg-slate-50",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>b(e),className:"rounded-lg border border-rose-300 px-3 py-1.5 text-sm text-rose-700 hover:bg-rose-50",children:"Hapus"})]}),(0,s.jsxs)("div",{className:"mt-3 text-xs text-slate-500",children:["slug: ",e.slug]})]},e.id))}),u&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/30 p-4",role:"dialog","aria-modal":"true",children:(0,s.jsxs)("div",{className:"w-full max-w-lg rounded-2xl bg-white p-5 shadow-xl",children:[(0,s.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:p?"Edit Paket":"Tambah Paket"}),(0,s.jsx)("button",{onClick:()=>m(!1),className:"rounded-lg border px-2 text-slate-600",children:"✕"})]}),(0,s.jsxs)("div",{className:"grid gap-3",children:[(0,s.jsxs)("label",{className:"block text-sm",children:[(0,s.jsx)("div",{className:"mb-1 text-slate-600",children:"Nama"}),(0,s.jsx)("input",{value:h.name,onChange:e=>x(t=>({...t,name:e.target.value})),className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm"})]}),(0,s.jsxs)("label",{className:"block text-sm",children:[(0,s.jsx)("div",{className:"mb-1 text-slate-600",children:"Slug"}),(0,s.jsx)("input",{value:h.slug,onChange:e=>x(t=>({...t,slug:e.target.value.replace(/\s+/g,"-").toLowerCase()})),className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm"})]}),(0,s.jsxs)("div",{className:"grid gap-3 sm:grid-cols-3",children:[(0,s.jsxs)("label",{className:"block text-sm sm:col-span-2",children:[(0,s.jsx)("div",{className:"mb-1 text-slate-600",children:"Harga (IDR)"}),(0,s.jsx)("input",{type:"number",inputMode:"numeric",min:0,value:h.amount,onChange:e=>{let t=e.target.value.replace(/[^\d]/g,"");x(e=>({...e,amount:t}))},className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm"}),(0,s.jsx)("div",{className:"mt-1 text-xs text-slate-500",children:"Isi 0 untuk paket gratis."})]}),(0,s.jsxs)("label",{className:"block text-sm",children:[(0,s.jsx)("div",{className:"mb-1 text-slate-600",children:"Interval"}),(0,s.jsxs)("select",{value:h.interval,onChange:e=>x(t=>({...t,interval:e.target.value})),className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",children:[(0,s.jsx)("option",{value:"month",children:"Bulanan"}),(0,s.jsx)("option",{value:"year",children:"Tahunan"})]})]})]}),(0,s.jsxs)("label",{className:"block text-sm",children:[(0,s.jsx)("div",{className:"mb-1 text-slate-600",children:"Trial (hari)"}),(0,s.jsx)("input",{type:"number",inputMode:"numeric",min:0,value:h.trialDays,onChange:e=>{let t=e.target.value.replace(/[^\d]/g,"");x(e=>({...e,trialDays:t}))},className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm"}),(0,s.jsx)("div",{className:"mt-1 text-xs text-slate-500",children:"Isi 0 jika tidak ada trial."})]}),(0,s.jsxs)("label",{className:"block text-sm",children:[(0,s.jsx)("div",{className:"mb-1 text-slate-600",children:"Deskripsi"}),(0,s.jsx)("textarea",{value:h.description,onChange:e=>x(t=>({...t,description:e.target.value})),rows:3,className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm",children:[(0,s.jsx)("input",{type:"checkbox",checked:h.active,onChange:e=>x(t=>({...t,active:e.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-blue-600"}),"Aktif"]}),(0,s.jsxs)("label",{className:"text-xs text-slate-500",children:["Price ID (opsional):",(0,s.jsx)("input",{value:h.priceId,onChange:e=>x(t=>({...t,priceId:e.target.value})),className:"ml-2 rounded-lg border border-slate-300 px-2 py-1"})]})]}),(0,s.jsxs)("div",{className:"mt-3 flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:()=>m(!1),className:"rounded-xl border border-slate-300 px-4 py-2 text-sm",children:"Batal"}),(0,s.jsx)("button",{onClick:f,disabled:!h.name||!h.slug||0>Number(h.amount),className:"rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",children:"Simpan"})]})]})]})})]})}},71837:function(e,t,a){"use strict";a.d(t,{Sg:function(){return n},hF:function(){return u},hi:function(){return d},vL:function(){return m}});var s=a(40257);let n=(s.env.NEXT_PUBLIC_API_URL||s.env.NEXT_PUBLIC_API_BASE||"http://localhost:4000").replace(/\/+$/,""),r="true"===(s.env.NEXT_PUBLIC_FORCE_DIRECT_API||"false"),i="true"===(s.env.NEXT_PUBLIC_SKIP_EMPLOYER_CHECK||"false");function l(e){return e?/^https?:\/\//i.test(e)?e:r?"".concat(n).concat(e.startsWith("/")?"":"/").concat(e):e.startsWith("/")?e:"".concat(n).concat(e.startsWith("/")?"":"/").concat(e):n}async function o(e){try{if((e.headers.get("content-type")||"").includes("application/json")){let t=await e.json().catch(()=>({}));return(null==t?void 0:t.message)||(null==t?void 0:t.error)||"HTTP ".concat(e.status)}return await e.text()||"HTTP ".concat(e.status)}catch(t){return"HTTP ".concat(e.status)}}async function c(e){try{if((e.headers.get("content-type")||"").includes("application/json"))return await e.json().catch(()=>({message:"Failed to parse error JSON"}));return{message:await e.text()||"HTTP ".concat(e.status)}}catch(t){return{message:"HTTP ".concat(e.status)}}}async function d(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{json:s,headers:n,expectJson:r=!0,...o}=a;try{if(String(e||"").toLowerCase().includes("/api/employers")&&(console.log("[TRACE][api] Employer endpoint called: ".concat(e)),console.trace(),i))throw Error("[SKIP_EMPLOYER_CHECK] skipped call to ".concat(e))}catch(e){console.warn("[TRACE][api] trace helper error (ignored):",e)}let d=new Headers(n||{}),u=o.body instanceof FormData;void 0===s||u||d.set("Content-Type","application/json");let m={credentials:"include",headers:d,...void 0!==s?{method:null!==(t=o.method)&&void 0!==t?t:"POST",body:JSON.stringify(s)}:{},...o},h=l(e),x=await fetch(h,m);if(!x.ok){let e=await c(x),t=Error((null==e?void 0:e.message)||(null==e?void 0:e.error)||"HTTP ".concat(x.status));throw t.response={data:e,status:x.status,config:{url:h}},t}return 204!==x.status&&r?(x.headers.get("content-type")||"").includes("application/json")?await x.json():await x.text():null}async function u(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{if(String(e||"").toLowerCase().includes("/api/employers")&&(console.log("[TRACE][apiForm] Employer endpoint called: ".concat(e)),console.trace(),i))throw Error("[SKIP_EMPLOYER_CHECK] skipped call to ".concat(e))}catch(e){console.warn("[TRACE][apiForm] trace helper error (ignored):",e)}let s=l(e),n=await fetch(s,{method:"POST",body:t,credentials:"include",...a});if(!n.ok){let e=await c(n),t=Error((null==e?void 0:e.message)||(null==e?void 0:e.error)||"HTTP ".concat(n.status));throw t.response={data:e,status:n.status,config:{url:s}},t}return(n.headers.get("content-type")||"").includes("application/json")?await n.json():null}async function m(){let e=function(e,t){if(!t)return e;let a=window.location.origin,s=new URL(e.startsWith("/")?"".concat(a).concat(e):e);for(let[e,a]of Object.entries(t))null!=a&&""!==a&&s.searchParams.set(e,String(a));return e.startsWith("/")?"".concat(s.pathname).concat(s.search):s.toString()}("".concat(n,"/api/rates"),{base:"USD",symbols:"IDR"}),t=await fetch(e,{cache:"no-store",credentials:"include"});if(!t.ok)throw Error("[".concat(t.status,"] ").concat(await o(t)));let a=await t.json().catch(()=>({})),s=Number(null==a?void 0:a.rate);if(!Number.isFinite(s))throw Error("Invalid rate");return s}}},function(e){e.O(0,[2971,2117,1744],function(){return e(e.s=69939)}),_N_E=e.O()}]);