(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[997],{9412:function(e,l,t){Promise.resolve().then(t.bind(t,10719))},99376:function(e,l,t){"use strict";var a=t(35475);t.o(a,"usePathname")&&t.d(l,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(l,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(l,{useSearchParams:function(){return a.useSearchParams}})},40257:function(e,l,t){"use strict";var a,s;e.exports=(null==(a=t.g.process)?void 0:a.env)&&"object"==typeof(null==(s=t.g.process)?void 0:s.env)?t.g.process:t(44227)},44227:function(e){!function(){var l={229:function(e){var l,t,a,s=e.exports={};function r(){throw Error("setTimeout has not been defined")}function n(){throw Error("clearTimeout has not been defined")}function i(e){if(l===setTimeout)return setTimeout(e,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(e){l=r}try{t="function"==typeof clearTimeout?clearTimeout:n}catch(e){t=n}}();var o=[],c=!1,d=-1;function u(){c&&a&&(c=!1,a.length?o=a.concat(o):d=-1,o.length&&m())}function m(){if(!c){var e=i(u);c=!0;for(var l=o.length;l;){for(a=o,o=[];++d<l;)a&&a[d].run();d=-1,l=o.length}a=null,c=!1,function(e){if(t===clearTimeout)return clearTimeout(e);if((t===n||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(e);try{t(e)}catch(l){try{return t.call(null,e)}catch(l){return t.call(this,e)}}}(e)}}function x(e,l){this.fun=e,this.array=l}function p(){}s.nextTick=function(e){var l=Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)l[t-1]=arguments[t];o.push(new x(e,l)),1!==o.length||c||i(m)},x.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=p,s.addListener=p,s.once=p,s.off=p,s.removeListener=p,s.removeAllListeners=p,s.emit=p,s.prependListener=p,s.prependOnceListener=p,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},t={};function a(e){var s=t[e];if(void 0!==s)return s.exports;var r=t[e]={exports:{}},n=!0;try{l[e](r,r.exports,a),n=!1}finally{n&&delete t[e]}return r.exports}a.ab="//";var s=a(229);e.exports=s}()},10719:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return u}});var a=t(57437),s=t(2265),r=t(99376),n=t(40257);let i=n.env.NEXT_PUBLIC_API_BASE||n.env.NEXT_PUBLIC_API_URL||"http://localhost:4000",o=e=>String(null!=e?e:"").replace(/[^\d]/g,""),c=e=>{let l=Number(o(null!=e?e:""));return Number.isFinite(l)&&""!==String(null!=e?e:"").trim()?l:null},d=e=>o(e).replace(/\B(?=(\d{3})+(?!\d))/g,",");function u(){let e=(0,r.useRouter)(),l=(0,r.useSearchParams)().get("id"),[t,n]=(0,s.useState)(!1),[u,m]=(0,s.useState)(null),[x,p]=(0,s.useState)(null),[h,b]=(0,s.useState)(""),[v,f]=(0,s.useState)(""),[g,y]=(0,s.useState)(""),[j,N]=(0,s.useState)(""),[w,k]=(0,s.useState)([]),[S,T]=(0,s.useState)([]),[C,M]=(0,s.useState)({title:"",location:"",employment:"Full-time",description:"",isDraft:!1,remote:!1,salaryMin:"",salaryMax:"",currency:"IDR",deadline:"",tags:"",requirements:"",experienceMinYears:"",education:""}),P=(e,l)=>M(t=>({...t,[e]:l}));async function E(e){if(e.preventDefault(),!h){p({type:"err",msg:"Tidak menemukan employer yang login. Silakan login sebagai employer."});return}if(!v.trim()){p({type:"err",msg:"Profil perusahaan belum lengkap (nama perusahaan)."});return}if(!C.title.trim()){p({type:"err",msg:"Judul lowongan wajib diisi."});return}if(!g||!j){p({type:"err",msg:"Pilih Provinsi dan Kab/Kota."});return}n(!0),p(null);try{let e={title:C.title.trim(),location:C.location,employment:C.employment,description:C.description,isDraft:C.isDraft,experienceMinYears:c(C.experienceMinYears),education:C.education||null,salaryMin:c(C.salaryMin),salaryMax:c(C.salaryMax),currency:C.currency,tags:C.tags.split(",").map(e=>e.trim()).filter(Boolean),remoteMode:C.remote?"REMOTE":"ON_SITE",company:v,deadline:C.deadline||null,requirements:C.requirements},l=await fetch("".concat(i.replace(/\/+$/,""),"/api/employer/jobs"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...e,employerId:h})}),t=await l.json().catch(()=>({}));if(!l.ok||!(null==t?void 0:t.ok)){let e=(null==t?void 0:t.error)||"HTTP ".concat(l.status);m("Tersimpan lokal. Gagal menyimpan ke server: ".concat(e));return}m("Job berhasil dipublikasikan.")}catch(e){m((null==e?void 0:e.message)==="Failed to fetch"?"Gagal terhubung ke server. Periksa BACKEND & NEXT_PUBLIC_API_BASE.":(null==e?void 0:e.message)||"Gagal menyimpan.")}finally{n(!1)}}return(0,s.useEffect)(()=>{(async()=>{try{let m,x;let p=i.replace(/\/+$/,""),h=await fetch("".concat(p,"/api/employers/me"),{credentials:"include"});if(h.ok){var e,l,t,a,s,r,n,o,c,d,u;let i=await h.json().catch(()=>({}));console.log("[employers/me] payload =",i),m=(null==i?void 0:null===(e=i.employer)||void 0===e?void 0:e.id)||(null==i?void 0:null===(t=i.data)||void 0===t?void 0:null===(l=t.employer)||void 0===l?void 0:l.id)||(null==i?void 0:i.id)||void 0,x=(null==i?void 0:null===(a=i.employer)||void 0===a?void 0:a.displayName)||(null==i?void 0:null===(r=i.data)||void 0===r?void 0:null===(s=r.employer)||void 0===s?void 0:s.displayName)||(null==i?void 0:null===(n=i.employer)||void 0===n?void 0:n.display_name)||(null==i?void 0:null===(c=i.data)||void 0===c?void 0:null===(o=c.employer)||void 0===o?void 0:o.display_name)||(null==i?void 0:null===(d=i.employer)||void 0===d?void 0:d.legalName)||(null==i?void 0:null===(u=i.employer)||void 0===u?void 0:u.legal_name)||void 0}else console.warn("[employers/me] HTTP",h.status);m||(m=localStorage.getItem("ark_employer_id")||void 0),x||(x=localStorage.getItem("ark_employer_company")||void 0),m&&b(String(m)),x&&f(String(x))}catch(e){console.warn("[employers/me] error:",e)}})()},[]),(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("https://www.emsifa.com/api-wilayah-indonesia/api/provinces.json"),l=await e.json();k(l)}catch(e){}})()},[]),(0,s.useEffect)(()=>{if(!g){T([]),N(""),P("location","");return}(async()=>{try{var e;let l=await fetch("https://www.emsifa.com/api-wilayah-indonesia/api/regencies/".concat(g,".json")),t=await l.json();T(t),N("");let a=(null===(e=w.find(e=>e.id===g))||void 0===e?void 0:e.name)||"";P("location",a)}catch(e){}})()},[g,w]),(0,s.useEffect)(()=>{var e,l;let t=(null===(e=w.find(e=>e.id===g))||void 0===e?void 0:e.name)||"";P("location",[(null===(l=S.find(e=>e.id===j))||void 0===l?void 0:l.name)||"",t].filter(Boolean).join(", "))},[j,g,w,S]),(0,a.jsxs)("main",{className:"min-h-[60vh] bg-slate-50",children:[(0,a.jsxs)("div",{className:"mx-auto max-w-3xl px-4 py-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:l?"Edit Job":"Post a Job"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-slate-600",children:"Isi detail lowongan. Nama perusahaan otomatis dari profil employer."}),(0,a.jsxs)("form",{onSubmit:E,className:"mt-6 space-y-5 rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-[1fr,2fr] items-end",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-slate-600 mb-1",children:"Company"}),(0,a.jsx)("div",{className:"inline-flex max-w-full items-center gap-2 rounded-xl border border-slate-300 bg-slate-50 px-3 py-2 text-sm",children:(0,a.jsx)("span",{className:"truncate font-medium",children:v||"—"})}),!v&&(0,a.jsx)("div",{className:"mt-1 text-xs text-amber-600",children:"Nama perusahaan belum terbaca—pastikan sudah login sebagai employer."})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-xs text-slate-600",children:"Job Title"}),(0,a.jsx)("input",{value:C.title,onChange:e=>P("title",e.target.value),required:!0,className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",placeholder:"Frontend Engineer"})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-xs text-slate-600",children:"Provinsi"}),(0,a.jsxs)("select",{value:g,onChange:e=>y(e.target.value),className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",children:[(0,a.jsx)("option",{value:"",children:"-- pilih --"}),w.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-xs text-slate-600",children:"Kab/Kota"}),(0,a.jsxs)("select",{value:j,onChange:e=>N(e.target.value),className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",disabled:!g,children:[(0,a.jsx)("option",{value:"",children:"-- pilih --"}),S.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-xs text-slate-600",children:"Location (gabungan)"}),(0,a.jsx)("input",{value:C.location,readOnly:!0,className:"w-full rounded-xl border border-slate-300 bg-slate-100 px-3 py-2 text-sm",placeholder:"Kab/Kota, Provinsi"})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-xs text-slate-600",children:"Employment"}),(0,a.jsxs)("select",{value:C.employment,onChange:e=>P("employment",e.target.value),className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",children:[(0,a.jsx)("option",{children:"Full-time"}),(0,a.jsx)("option",{children:"Part-time"}),(0,a.jsx)("option",{children:"Contract"}),(0,a.jsx)("option",{children:"Internship"})]})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-xs text-slate-600",children:"Currency"}),(0,a.jsxs)("select",{value:C.currency,onChange:e=>P("currency",e.target.value),className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",children:[(0,a.jsx)("option",{children:"IDR"}),(0,a.jsx)("option",{children:"USD"})]})]}),(0,a.jsxs)("label",{className:"mt-6 inline-flex items-center gap-2 text-sm text-slate-700",children:[(0,a.jsx)("input",{type:"checkbox",checked:C.remote,onChange:e=>P("remote",e.target.checked),className:"h-4 w-4 rounded border-slate-300 text-blue-600"}),"Remote-friendly"]})]}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-xs text-slate-600",children:"Salary Min"}),(0,a.jsx)("input",{value:C.salaryMin,onChange:e=>P("salaryMin",d(e.target.value)),inputMode:"numeric",className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",placeholder:"10,000,000"})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-xs text-slate-600",children:"Salary Max"}),(0,a.jsx)("input",{value:C.salaryMax,onChange:e=>P("salaryMax",d(e.target.value)),inputMode:"numeric",className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",placeholder:"20,000,000"})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-xs text-slate-600",children:"Min Experience (years)"}),(0,a.jsx)("input",{value:C.experienceMinYears,onChange:e=>P("experienceMinYears",o(e.target.value)),inputMode:"numeric",className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",placeholder:"0"})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-xs text-slate-600",children:"Education"}),(0,a.jsxs)("select",{value:C.education,onChange:e=>P("education",e.target.value),className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",children:[(0,a.jsx)("option",{value:"",children:"Any"}),(0,a.jsx)("option",{value:"SMA/SMK",children:"SMA/SMK"}),(0,a.jsx)("option",{value:"D3",children:"D3"}),(0,a.jsx)("option",{value:"S1",children:"S1"}),(0,a.jsx)("option",{value:"S2",children:"S2"}),(0,a.jsx)("option",{value:"S3",children:"S3"})]})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-xs text-slate-600",children:"Deadline"}),(0,a.jsx)("input",{type:"date",value:C.deadline,onChange:e=>P("deadline",e.target.value),className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm"})]})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-xs text-slate-600",children:"Tags (comma separated)"}),(0,a.jsx)("input",{value:C.tags,onChange:e=>P("tags",e.target.value),className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",placeholder:"react, nextjs, tailwind"})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-xs text-slate-600",children:"Description"}),(0,a.jsx)("textarea",{value:C.description,onChange:e=>P("description",e.target.value),rows:5,className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",placeholder:"Describe the role…"})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-xs text-slate-600",children:"Requirements"}),(0,a.jsx)("textarea",{value:C.requirements,onChange:e=>P("requirements",e.target.value),rows:5,className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",placeholder:"- 3+ years…"})]}),(0,a.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm text-slate-700",children:[(0,a.jsx)("input",{type:"checkbox",checked:C.isDraft,onChange:e=>P("isDraft",e.target.checked),className:"h-4 w-4 rounded border-slate-300 text-blue-600"}),"Save as draft (server)"]}),(0,a.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>history.back(),className:"rounded-xl border border-slate-200 px-4 py-2 text-sm text-slate-700 hover:bg-slate-50",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:t,className:"rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",children:t?"Publishing…":"Publish Job"})]})]})]}),x&&(0,a.jsx)("div",{className:"fixed inset-x-0 bottom-6 z-[60] flex justify-center px-4",children:(0,a.jsx)("div",{className:"pointer-events-auto w-full max-w-md rounded-2xl border p-4 shadow-2xl backdrop-blur ".concat("ok"===x.type?"border-emerald-200 bg-emerald-50 text-emerald-900":"border-rose-200 bg-rose-50 text-rose-900"),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"grid h-6 w-6 place-items-center rounded-full bg-black/10",children:"ok"===x.type?"✓":"!"}),(0,a.jsx)("div",{className:"flex-1 text-sm",children:x.msg}),(0,a.jsx)("button",{onClick:()=>p(null),className:"rounded-lg border px-2 text-xs hover:bg-white/50",children:"Close"})]})})}),u&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/40 p-4",children:(0,a.jsxs)("div",{className:"w-full max-w-sm rounded-2xl bg-white p-6 shadow-xl",children:[(0,a.jsx)("h2",{className:"text-center text-lg font-semibold text-slate-900",children:"Berhasil"}),(0,a.jsx)("p",{className:"mt-2 whitespace-pre-line text-center text-sm text-slate-600",children:u}),(0,a.jsx)("div",{className:"mt-5",children:(0,a.jsx)("button",{onClick:()=>{m(null),e.push("/jobs")},className:"w-full rounded-lg bg-slate-900 px-4 py-2 text-sm font-medium text-white hover:bg-slate-800",children:"Oke"})})]})})]})}}},function(e){e.O(0,[2971,2117,1744],function(){return e(e.s=9412)}),_N_E=e.O()}]);