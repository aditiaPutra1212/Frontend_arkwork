(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7702],{52851:function(e,t,r){Promise.resolve().then(r.bind(r,50441))},99376:function(e,t,r){"use strict";var a=r(35475);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},50441:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return g}});var a=r(57437),s=r(27648),n=r(2265),l=r(84603),o=r(99376),i=r(38706),d=r(64574);function c(e){return(0,a.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",...e,children:(0,a.jsx)("path",{d:"M5 12h14M13 5l7 7-7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function u(e){return(0,a.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",...e,children:(0,a.jsx)("path",{d:"M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-5 0-9 3-9 6v1h18v-1c0-3-4-6-9-6Z",stroke:"currentColor",strokeWidth:"2"})})}function m(e){return(0,a.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",...e,children:[(0,a.jsx)("rect",{x:"3",y:"7",width:"18",height:"13",rx:"2",stroke:"currentColor",strokeWidth:"2"}),(0,a.jsx)("path",{d:"M8 7V5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",stroke:"currentColor",strokeWidth:"2"})]})}function x(e){return(0,a.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",...e,children:[(0,a.jsx)("path",{d:"M7 3h6l4 4v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Z",stroke:"currentColor",strokeWidth:"2"}),(0,a.jsx)("path",{d:"M13 3v4h4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}function h(e){return(0,a.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",...e,children:(0,a.jsx)("path",{d:"m5 13 4 4 10-10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function f(e){let{w:t="100%"}=e;return(0,a.jsx)("div",{className:"h-3 rounded bg-neutral-200 animate-pulse",style:{width:t}})}async function p(e,t){try{let r=await new Promise((e,t)=>{let r=indexedDB.open("ark_db",2);r.onupgradeneeded=()=>{let e=r.result;e.objectStoreNames.contains("cv_files")||e.createObjectStore("cv_files"),e.objectStoreNames.contains("avatar_files")||e.createObjectStore("avatar_files")},r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),a=await new Promise(a=>{let s=r.transaction(e,"readonly"),n=s.objectStore(e).getKey(t);n.onsuccess=()=>a(!!n.result),n.onerror=()=>{console.error("IndexedDB getKey error in store ".concat(e,":"),n.error),a(!1)},s.onerror=()=>{console.error("IndexedDB transaction error in store ".concat(e,":"),s.error),a(!1)}});return r.close(),a}catch(t){return console.error("IndexedDB access error for store ".concat(e,":"),t),!1}}function g(){let e=(0,o.useRouter)(),t=(0,l.a)(),{user:r,loading:g}=t,v=(0,i.T_)("dashboard"),b=(0,d.bU)(),j=(0,n.useRef)(!1),[w,N]=(0,n.useState)(""),[k,y]=(0,n.useState)(!1),[S,D]=(0,n.useState)(!1),[C,L]=(0,n.useState)(0),[_,P]=(0,n.useState)(!1),[E,B]=(0,n.useState)(0),[I,R]=(0,n.useState)([]),V=(0,n.useMemo)(()=>new Intl.DateTimeFormat(b,{year:"numeric",month:"short",day:"2-digit"}),[b]),M=(0,n.useCallback)(()=>{try{var e;return JSON.parse(null!==(e=localStorage.getItem("ark_users"))&&void 0!==e?e:"[]")}catch(e){return[]}},[]),O=(0,n.useCallback)(e=>{try{var t,r;let a=localStorage.getItem("ark_apps"),s=localStorage.getItem("ark_jobs"),n=null!==(r=null===(t=JSON.parse(null!=a?a:"{}"))||void 0===t?void 0:t[e])&&void 0!==r?r:[],l=JSON.parse(null!=s?s:"[]");return n.filter(e=>{var t;return"hired"===String(null!==(t=null==e?void 0:e.status)&&void 0!==t?t:"").toLowerCase()}).map(e=>{var t;let r=l.find(t=>t.id===e.jobId);return{jobId:e.jobId,title:null!==(t=null==r?void 0:r.title)&&void 0!==t?t:"Unknown Job",date:e.updatedAt||e.createdAt||""}}).sort((e,t)=>+new Date(t.date)-+new Date(e.date)).slice(0,5)}catch(e){return[]}},[]),W=(0,n.useCallback)(async e=>{var t,a,s,n,l,o,i,d,c,u;let m;console.log("[refreshProfileStats] Refreshing for email:",e);let x=M().find(t=>t.email===e);console.log("[refreshProfileStats] Found user data in localStorage:",x);let h=((null!==(d=localStorage.getItem("ark_nav_name:"+e))&&void 0!==d?d:"")||(null==x?void 0:x.name)||(null==r?void 0:r.name)||"").trim();N(h||v("fallback.there"));let f=(null!==(c=null==x?void 0:null===(t=x.profile)||void 0===t?void 0:t.skills)&&void 0!==c?c:"").split(",").map(e=>e.trim()).filter(Boolean);L(f.length),P(!!h&&!!(null==x?void 0:null===(a=x.profile)||void 0===a?void 0:a.location)&&!!(null==x?void 0:null===(s=x.profile)||void 0===s?void 0:s.phone));let g=null==x?void 0:null===(l=x.profile)||void 0===l?void 0:null===(n=l.cv)||void 0===n?void 0:n.key,b=!1;g&&(b=await p("cv_files",g)),y(b),console.log("[refreshProfileStats] CV Check (key: ".concat(g,"):"),b);try{{let t=JSON.parse(null!==(u=localStorage.getItem("ark_cv_drafts"))&&void 0!==u?u:"{}");D(!!(null==t?void 0:t[e])),console.log("[refreshProfileStats] CV Draft Check:",!!(null==t?void 0:t[e]))}}catch(e){D(!1)}let j=O(e);R(j),console.log("[refreshProfileStats] Accepted Apps:",j);let w=Math.round((m=0+(h?1:0)+((null==x?void 0:null===(o=x.profile)||void 0===o?void 0:o.location)?1:0)+((null==x?void 0:null===(i=x.profile)||void 0===i?void 0:i.phone)?1:0)+(b||S?1:0)+(f.length>=3?1:0))/5*100);B(w),console.log("[refreshProfileStats] Progress: ".concat(w,"% (Score: ").concat(m,"/5)"))},[M,O,v,null==r?void 0:r.name]);return((0,n.useEffect)(()=>{console.log("[Dashboard Effect] Running. Loading: ".concat(g,", User:"),r),(async()=>{if(g)console.log("[Dashboard Effect] Still loading session..."),j.current=!1;else if(r){if(j.current=!1,console.log("[Dashboard Effect] User authenticated (".concat(r.email||r.username,"). Checking role...")),"admin"===r.role||"employer"===r.role){console.warn("[Dashboard Effect] Invalid role (".concat(r.role,") for dashboard, redirecting to login.")),t.signout().finally(()=>{e.replace("/auth/signin")});return}if(r.email){console.log("[Dashboard Effect] User valid, refreshing profile stats for ".concat(r.email,"...")),W(r.email);let e=()=>{(null==r?void 0:r.email)&&W(r.email)};return window.addEventListener("ark:profile-updated",e),window.addEventListener("ark:avatar-updated",e),window.addEventListener("storage",e),()=>{window.removeEventListener("ark:profile-updated",e),window.removeEventListener("ark:avatar-updated",e),window.removeEventListener("storage",e)}}console.warn("[Dashboard Effect] User authenticated but email is missing.")}else{if(j.current){console.log("[Dashboard Effect] Still no user after refresh attempt, redirecting to login."),e.replace("/auth/signin");return}console.log("[Dashboard Effect] No user after load, attempting auth.refresh()..."),j.current=!0;try{await t.refresh()}catch(e){console.error("[Dashboard Effect] auth.refresh() failed:",e)}return}})()},[g,r,e,v,t,W]),g||!r&&j.current)?(console.log("[Dashboard Render] Showing loading skeleton..."),(0,a.jsx)("div",{className:"min-h-screen bg-neutral-50 py-10",children:(0,a.jsxs)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[(0,a.jsx)("div",{className:"rounded-3xl bg-gradient-to-br from-neutral-900 via-neutral-800 to-neutral-700 p-6 shadow-lg animate-pulse",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"h-4 w-32 rounded bg-neutral-700/70"}),(0,a.jsx)("div",{className:"h-8 w-56 rounded bg-neutral-700/70"}),(0,a.jsx)("div",{className:"h-4 w-72 rounded bg-neutral-700/60"})]})}),(0,a.jsxs)("div",{className:"mt-8 grid gap-6 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"rounded-2xl border border-neutral-200 bg-white p-6 shadow-sm animate-pulse",children:[(0,a.jsx)("div",{className:"mb-4 h-6 w-40 rounded bg-neutral-200"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f,{}),(0,a.jsx)(f,{w:"90%"}),(0,a.jsx)(f,{w:"70%"})]}),(0,a.jsx)("div",{className:"mt-5 h-9 w-32 rounded-lg bg-neutral-200"})]}),(0,a.jsxs)("div",{className:"rounded-2xl border border-neutral-200 bg-white p-6 shadow-sm animate-pulse",children:[(0,a.jsx)("div",{className:"mb-4 h-6 w-40 rounded bg-neutral-200"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(f,{}),(0,a.jsx)(f,{w:"95%"}),(0,a.jsx)(f,{w:"80%"})]}),(0,a.jsx)("div",{className:"mt-5 h-9 w-36 rounded-lg bg-neutral-200"})]})]})]})})):r?(console.log("[Dashboard Render] Rendering dashboard content for user:",r),(0,a.jsx)("div",{className:"min-h-screen bg-neutral-50 py-10",children:(0,a.jsxs)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[(0,a.jsx)("section",{className:"overflow-hidden rounded-3xl bg-gradient-to-br from-neutral-900 via-neutral-800 to-neutral-700 shadow-lg",children:(0,a.jsx)("div",{className:"p-6 sm:p-8",children:(0,a.jsxs)("div",{className:"flex flex-col items-start justify-between gap-6 md:flex-row md:items-center",children:[(0,a.jsxs)("div",{className:"text-neutral-200",children:[(0,a.jsx)("p",{className:"text-sm tracking-wide text-neutral-300",children:v("greetingSmall")||"Welcome back,"}),(0,a.jsx)("h1",{className:"mt-1 text-2xl font-semibold tracking-tight text-white sm:text-3xl",children:v("greeting",{name:w||r.name||v("fallback.there")})}),(0,a.jsx)("p",{className:"mt-2 max-w-xl text-sm text-neutral-300",children:v("hero.subtitle")||"Pantau profil dan kelola CV kamu di satu tempat."})]}),(0,a.jsxs)("div",{className:"flex w-full gap-3 md:w-auto",children:[(0,a.jsxs)(s.default,{href:"/jobs",className:"inline-flex flex-1 items-center justify-center gap-2 rounded-xl bg-white px-4 py-2 text-sm font-semibold text-neutral-900 shadow-sm transition hover:bg-neutral-100 md:flex-none",children:[(0,a.jsx)(m,{className:"h-4 w-4"})," ",v("cta.findJobs")||"Cari Lowongan"]}),(0,a.jsxs)(s.default,{href:"/profile",className:"inline-flex flex-1 items-center justify-center gap-2 rounded-xl border border-white/30 bg-transparent px-4 py-2 text-sm font-semibold text-white backdrop-blur transition hover:bg-white/10 md:flex-none",children:[(0,a.jsx)(u,{className:"h-4 w-4"})," ",v("profile.title")||"Profil Saya"]})]})]})})}),(0,a.jsxs)("section",{className:"mt-8 grid gap-6 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"rounded-2xl border border-neutral-200 bg-white p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-neutral-900",children:v("profile.title")}),(0,a.jsx)("span",{className:"rounded-full bg-neutral-100 px-3 py-1 text-xs text-neutral-600",children:v("profile.badge")||"Akun"})]}),(0,a.jsx)("p",{className:"text-sm text-neutral-600",children:v("profile.desc")}),(0,a.jsxs)("div",{className:"mt-4",children:[" ",(0,a.jsxs)("div",{className:"mb-1 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-xs text-neutral-500",children:v("profile.completeness")||"Kelengkapan Profil"}),(0,a.jsxs)("span",{className:"text-xs font-medium text-neutral-700",children:[E,"%"]})]}),(0,a.jsx)("div",{className:"h-2 w-full overflow-hidden rounded-full bg-neutral-100",children:(0,a.jsx)("div",{className:"h-2 rounded-full bg-neutral-900 transition-[width] duration-500 ease-out",style:{width:"".concat(E,"%")}})})]}),(0,a.jsxs)("div",{className:"mt-5",children:[" ",(0,a.jsxs)(s.default,{href:"/profile",className:"group inline-flex items-center gap-2 rounded-xl bg-neutral-900 px-4 py-2 text-sm font-medium text-white shadow-sm transition hover:bg-neutral-800",children:[v("profile.cta")," ",(0,a.jsx)(c,{className:"h-4 w-4 transition group-hover:translate-x-0.5"})]})]}),(0,a.jsxs)("div",{className:"mt-6 grid grid-cols-3 gap-3 text-center",children:[" ",(0,a.jsxs)("div",{className:"rounded-2xl border border-neutral-200 p-3",children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:v("profile.stats.profile")}),(0,a.jsx)("p",{className:"mt-1 text-lg font-semibold ".concat(_?"text-green-600":"text-amber-600"),children:_?"✔︎":"Lengkapi"})]}),(0,a.jsxs)("div",{className:"rounded-2xl border border-neutral-200 p-3",children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:v("profile.stats.skills")}),(0,a.jsx)("p",{className:"mt-1 text-lg font-semibold text-neutral-900",children:C})]}),(0,a.jsxs)("div",{className:"rounded-2xl border border-neutral-200 p-3",children:[(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"CV"}),(0,a.jsx)("p",{className:"mt-1 text-lg font-semibold ".concat(k||S?"text-green-600":"text-amber-600"),children:k||S?"Siap":"Belum"})]})]})]}),(0,a.jsxs)("div",{className:"rounded-2xl border border-neutral-200 bg-white p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-neutral-900",children:"Buat CV (ATS)"}),(0,a.jsx)(x,{className:"h-5 w-5 text-neutral-400"})]}),(0,a.jsx)("p",{className:"text-sm text-neutral-600",children:"Susun CV format ATS yang rapi dan siap kirim. Kamu bisa lanjutkan dari draft yang tersimpan otomatis."}),(0,a.jsx)("div",{className:"mt-4 flex items-center gap-2 text-sm",children:(0,a.jsx)("span",{className:"rounded-full bg-neutral-100 px-2.5 py-1 text-neutral-700",children:S?"Draft ditemukan":"Belum ada draft"})}),(0,a.jsx)("div",{className:"mt-5 flex flex-wrap items-center gap-3",children:(0,a.jsxs)(s.default,{href:"/cv",className:"group inline-flex items-center gap-2 rounded-xl bg-neutral-900 px-4 py-2 text-sm font-medium text-white shadow-sm transition hover:bg-neutral-800",children:[S?"Lanjutkan Draft":"Buat CV Sekarang"," ",(0,a.jsx)(c,{className:"h-4 w-4 transition group-hover:translate-x-0.5"})]})})]}),(0,a.jsxs)("div",{className:"rounded-2xl border border-neutral-200 bg-white p-6 shadow-sm md:col-span-2",children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-neutral-900",children:"Lamaran Diterima"}),(0,a.jsx)(h,{className:"h-5 w-5 text-green-600"})]}),0===I.length?(0,a.jsxs)("div",{className:"rounded-xl border border-dashed border-neutral-200 p-5 text-center",children:[(0,a.jsxs)("p",{className:"text-sm text-neutral-600",children:["Belum ada lamaran yang ditandai sebagai ",(0,a.jsx)("span",{className:"font-medium",children:"diterima"}),"."]}),(0,a.jsxs)(s.default,{href:"/applications",className:"mt-3 inline-flex items-center gap-2 rounded-xl bg-neutral-900 px-3 py-1.5 text-sm font-medium text-white hover:bg-neutral-800",children:["Lihat Semua Lamaran ",(0,a.jsx)(c,{className:"h-4 w-4"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("ul",{className:"space-y-3",children:I.map((e,t)=>{let r=new Date(e.date),n=isNaN(r.getTime())?e.date:V.format(r);return(0,a.jsxs)("li",{className:"flex items-start justify-between gap-3 rounded-xl border border-neutral-200 p-3",children:[(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("p",{className:"truncate text-sm font-medium text-neutral-900",children:e.title}),(0,a.jsxs)("p",{className:"mt-0.5 text-xs text-neutral-500",children:["Diterima: ",n]})]}),(0,a.jsxs)(s.default,{href:"/jobs/".concat(e.jobId),className:"inline-flex items-center gap-1 rounded-lg border border-neutral-200 px-2 py-1 text-xs text-neutral-700 hover:bg-neutral-50",children:["Detail Pekerjaan ",(0,a.jsx)(c,{className:"h-3.5 w-3.5"})]})]},"".concat(e.jobId,"-").concat(t))})}),(0,a.jsx)("div",{className:"mt-5",children:(0,a.jsxs)(s.default,{href:"/applications",className:"group inline-flex items-center gap-2 rounded-xl bg-neutral-100 px-4 py-2 text-sm font-medium text-neutral-800 transition hover:bg-neutral-200",children:["Lihat Semua Lamaran ",(0,a.jsx)(c,{className:"h-4 w-4 transition group-hover:translate-x-0.5"})]})})]})]})]})]})})):(console.error("[Dashboard Render] User is null after loading and refresh attempt."),(0,a.jsx)("div",{className:"p-6",children:"Verifying session... Please wait or try logging in again."}))}},38706:function(e,t,r){"use strict";r.d(t,{T_:function(){return n}});var a=r(64574);function s(e,t){return(...e)=>{try{return t(...e)}catch{throw Error(void 0)}}}let n=s(0,a.T_);s(0,a.Gb)}},function(e){e.O(0,[4574,6933,4603,2971,2117,1744],function(){return e(e.s=52851)}),_N_E=e.O()}]);