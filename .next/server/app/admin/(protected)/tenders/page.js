(()=>{var e={};e.id=816,e.ids=[816],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},49411:e=>{"use strict";e.exports=require("node:path")},97742:e=>{"use strict";e.exports=require("node:process")},41041:e=>{"use strict";e.exports=require("node:url")},67242:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>o}),a(13686),a(76630),a(55512),a(90996);var s=a(30170),r=a(45002),n=a(83876),l=a.n(n),i=a(66299),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);a.d(t,d);let o=["",{children:["admin",{children:["(protected)",{children:["tenders",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,13686)),"D:\\tugas\\magang\\frontend-arkwork1\\src\\app\\admin\\(protected)\\tenders\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,76630)),"D:\\tugas\\magang\\frontend-arkwork1\\src\\app\\admin\\(protected)\\layout.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,55512)),"D:\\tugas\\magang\\frontend-arkwork1\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,90996,23)),"next/dist/client/components/not-found-error"]}],c=["D:\\tugas\\magang\\frontend-arkwork1\\src\\app\\admin\\(protected)\\tenders\\page.tsx"],u="/admin/(protected)/tenders/page",x={require:a,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/(protected)/tenders/page",pathname:"/admin/tenders",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},37972:(e,t,a)=>{Promise.resolve().then(a.bind(a,3719))},3719:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var s=a(97247),r=a(28964),n=a(90002);let l="/api/admin/tenders",i=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0});function d(e){let t=Number((e||"").replace(/[^\d]/g,""));return Number.isFinite(t)?t:0}function o(){let e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function c(){let[e,t]=(0,r.useState)(null),[a,c]=(0,r.useState)(null),[h,g]=(0,r.useState)(!1),[j,b]=(0,r.useState)(null),[v,N]=(0,r.useState)({title:"",buyer:"",sector:"OIL_GAS",status:"OPEN",contract:"EPC",provinceId:"",regencyId:"",budgetIDR:"",deadline:o(),description:"",documentsCsv:""}),f=(e,t)=>N(a=>({...a,[e]:t})),{data:y}=function(){let[e,t]=(0,r.useState)([]),[a,s]=(0,r.useState)(!0),[n,l]=(0,r.useState)(null);return{data:e,loading:a,error:n}}(),{data:S}=function(e){let[t,a]=(0,r.useState)([]),[s,n]=(0,r.useState)(!1),[l,i]=(0,r.useState)(null);return{data:t,loading:s,error:l}}(v.provinceId),[I,E]=(0,r.useState)([]),[C,D]=(0,r.useState)(!0),[w,k]=(0,r.useState)(null),[P,R]=(0,r.useState)(null);async function T(){D(!0),k(null);try{let e=await (0,n.hi)(l),t=Array.isArray(e)?e:Array.isArray(e?.items)?e.items:Array.isArray(e?.data)?e.data:[];t.sort((e,t)=>+new Date(t?.createdAt||0)-+new Date(e?.createdAt||0)),E(t)}catch(e){k(e?.message||"Failed to load tenders")}finally{D(!1)}}async function A(e){if(e.preventDefault(),b(null),!v.title.trim()||!v.buyer.trim()){b("Mohon isi Title dan Owner.");return}if(!v.provinceId||!v.regencyId){b("Mohon pilih Provinsi dan Kabupaten/Kota.");return}let t=y.find(e=>e.id===v.provinceId)?.name||"",a=[S.find(e=>e.id===v.regencyId)?.name||"",t].filter(Boolean).join(", "),s=d(v.budgetIDR);g(!0);try{let e={title:v.title.trim(),buyer:v.buyer.trim(),sector:v.sector,location:a,status:v.status,contract:v.contract,budgetUSD:Math.max(0,Math.round(s)),description:v.description.trim(),documents:v.documentsCsv.split(",").map(e=>e.trim()).filter(Boolean),deadline:new Date(v.deadline+"T00:00:00").toISOString()};await (0,n.hi)(l,{json:e}),alert("Tender created!"),N(e=>({...e,title:"",buyer:"",budgetIDR:"",description:"",documentsCsv:""})),T()}catch(e){b(e?.message||"Failed to create tender")}finally{g(!1)}}async function O(e){if(confirm("Delete this tender? This action cannot be undone."))try{await (0,n.hi)(`${l}/${e}`,{method:"DELETE",expectJson:!1}),E(t=>t.filter(t=>t.id!==e))}catch(e){alert(e?.message||"Failed to delete tender")}}let L=(0,r.useMemo)(()=>["EPC","SUPPLY","CONSULTING","MAINTENANCE","PSC","SERVICE","JOC","TURNKEY","LOGISTICS","DRILLING","O_M"],[]);return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"rounded-2xl border border-neutral-200 bg-white p-5 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-neutral-900",children:"Tenders Management"}),s.jsx("p",{className:"mt-1 text-sm text-neutral-600",children:"Buat tender, atur status, unggah dokumen (pisahkan dengan koma), dan lengkapi detail."})]}),(0,s.jsxs)("div",{className:"rounded-xl border border-neutral-200 p-2 text-xs text-neutral-700",children:[s.jsx("div",{className:"font-medium",children:"Kurs aktif"}),a?s.jsx("div",{className:"text-rose-600",children:"Tidak tersedia • tampil IDR apa adanya"}):s.jsx("div",{children:e?(0,s.jsxs)(s.Fragment,{children:["1 USD ≈ ",i.format(e)]}):"Memuat…"})]})]}),(0,s.jsxs)("form",{onSubmit:A,className:"mt-6 grid gap-4 max-w-3xl",children:[j&&s.jsx("div",{className:"rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-700",children:j}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Title"}),s.jsx("input",{value:v.title,onChange:e=>f("title",e.target.value),className:"rounded-xl border px-3 py-2",required:!0})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Owner"}),s.jsx("input",{value:v.buyer,onChange:e=>f("buyer",e.target.value),className:"rounded-xl border px-3 py-2",required:!0})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Sector"}),(0,s.jsxs)("select",{value:v.sector,onChange:e=>f("sector",e.target.value),className:"rounded-xl border px-3 py-2",children:[s.jsx("option",{value:"OIL_GAS",children:"OIL_GAS"}),s.jsx("option",{value:"RENEWABLE_ENERGY",children:"RENEWABLE_ENERGY"}),s.jsx("option",{value:"UTILITIES",children:"UTILITIES"}),s.jsx("option",{value:"ENGINEERING",children:"ENGINEERING"})]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Status"}),(0,s.jsxs)("select",{value:v.status,onChange:e=>f("status",e.target.value),className:"rounded-xl border px-3 py-2",children:[s.jsx("option",{value:"OPEN",children:"OPEN"}),s.jsx("option",{value:"PREQUALIFICATION",children:"PREQUALIFICATION"}),s.jsx("option",{value:"CLOSED",children:"CLOSED"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Contract"}),s.jsx("select",{value:v.contract,onChange:e=>f("contract",e.target.value),className:"rounded-xl border px-3 py-2",children:L.map(e=>s.jsx("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Provinsi"}),(0,s.jsxs)("select",{value:v.provinceId,onChange:e=>f("provinceId",e.target.value),className:"rounded-xl border px-3 py-2",children:[s.jsx("option",{value:"",disabled:!0,children:"Pilih provinsi…"}),y.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]})]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Kabupaten / Kota"}),(0,s.jsxs)("select",{value:v.regencyId,onChange:e=>f("regencyId",e.target.value),className:"rounded-xl border px-3 py-2",disabled:!v.provinceId,required:!0,children:[s.jsx("option",{value:"",disabled:!0,children:v.provinceId?"Pilih kabupaten/kota…":"Pilih provinsi dulu"}),S.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),s.jsx("p",{className:"text-xs text-neutral-500",children:"Pilih provinsi terlebih dahulu untuk memuat kabupaten/kota."})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Nilai Proyek (IDR)"}),s.jsx("input",{value:v.budgetIDR,onChange:e=>f("budgetIDR",p(e.target.value)),placeholder:"contoh: 1.000.000",className:"rounded-xl border px-3 py-2",inputMode:"numeric"}),s.jsx("p",{className:"text-xs text-neutral-500",children:"Disimpan ke database sebagai IDR (tanpa konversi)."})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Deadline"}),s.jsx("input",{type:"date",value:v.deadline,onChange:e=>f("deadline",e.target.value),className:"rounded-xl border px-3 py-2"})]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Description"}),s.jsx("textarea",{value:v.description,onChange:e=>f("description",e.target.value),className:"min-h-32 rounded-xl border px-3 py-2"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Documents (comma separated)"}),s.jsx("input",{value:v.documentsCsv,onChange:e=>f("documentsCsv",e.target.value),className:"rounded-xl border px-3 py-2",placeholder:"RFP.pdf, BoQ.xlsx"})]}),s.jsx("div",{className:"pt-2",children:s.jsx("button",{type:"submit",disabled:h,className:"rounded-xl bg-neutral-900 px-4 py-2.5 text-white hover:opacity-90 disabled:opacity-60",children:h?"Creating…":"Create"})})]})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-neutral-200 bg-white p-5 shadow-sm",children:[(0,s.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[s.jsx("h3",{className:"text-base font-semibold text-neutral-900",children:"Existing Tenders"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs text-neutral-500",children:e?`Kurs aktif: 1 USD ≈ ${i.format(e)} • Tampil IDR asli`:"Memuat kurs…"}),s.jsx("button",{onClick:T,className:"rounded-xl border border-neutral-300 bg-white px-3 py-1.5 text-sm hover:bg-neutral-50",children:"Refresh"})]})]}),w&&s.jsx("div",{className:"mb-3 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-700",children:w}),C?s.jsx("div",{className:"rounded-xl border border-dashed p-8 text-center text-sm text-neutral-600",children:"Loading…"}):0===I.length?s.jsx("div",{className:"rounded-xl border border-dashed p-8 text-center text-sm text-neutral-600",children:"No tenders yet."}):s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"border-b bg-neutral-50 text-left",children:[s.jsx(x,{children:"Title"}),s.jsx(x,{children:"Buyer"}),s.jsx(x,{children:"Sector"}),s.jsx(x,{children:"Status"}),s.jsx(x,{children:"Contract"}),s.jsx(x,{children:"Project Value (IDR)"}),s.jsx(x,{children:"Deadline"}),s.jsx(x,{className:"text-right",children:"Actions"})]})}),s.jsx("tbody",{children:I.map(e=>{let t=Math.max(0,Number(e.budgetUSD||0));return(0,s.jsxs)("tr",{className:"border-b last:border-0",children:[s.jsx(m,{className:"font-medium",children:e.title}),s.jsx(m,{children:e.buyer}),s.jsx(m,{children:e.sector}),s.jsx(m,{children:e.status}),s.jsx(m,{children:e.contract}),s.jsx(m,{children:i.format(t)}),s.jsx(m,{children:function(e){if(!e)return"-";try{let t=new Date(e),a=String(t.getDate()).padStart(2,"0"),s=String(t.getMonth()+1).padStart(2,"0"),r=t.getFullYear();return`${a}/${s}/${r}`}catch{return e||"-"}}(e.deadline)}),(0,s.jsxs)(m,{className:"text-right space-x-2",children:[s.jsx("button",{onClick:()=>R(e),className:"rounded-lg border border-neutral-300 px-2.5 py-1 text-xs hover:bg-neutral-50",title:"Edit",children:"Edit"}),s.jsx("button",{onClick:()=>O(e.id),className:"rounded-lg border border-red-500 px-2.5 py-1 text-xs text-red-600 hover:bg-red-50",title:"Delete tender",children:"Delete"})]})]},e.id)})})]})})]}),P&&s.jsx(u,{data:P,onClose:()=>R(null),onUpdated:T,contractOptions:L})]})}function u({data:e,onClose:t,onUpdated:a,contractOptions:i}){let[c,u]=(0,r.useState)(!1),[x,m]=(0,r.useState)(null),[h,g]=(0,r.useState)(e.title),[j,b]=(0,r.useState)(e.buyer),[v,N]=(0,r.useState)(e.sector),[f,y]=(0,r.useState)(e.status),[S,I]=(0,r.useState)(e.contract),[E,C]=(0,r.useState)(e.location),[D,w]=(0,r.useState)(p(String(e.budgetUSD||""))),[k,P]=(0,r.useState)(function(e){try{let t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}catch{return o()}}(e.deadline)),[R,T]=(0,r.useState)(e.description||""),[A,O]=(0,r.useState)((e.documents||[]).join(", "));async function L(s){if(s.preventDefault(),m(null),!h.trim()||!j.trim()){m("Mohon isi Title dan Owner.");return}let r=d(D),i={title:h.trim(),buyer:j.trim(),sector:v,status:f,contract:S,location:E.trim(),budgetUSD:Math.max(0,Math.round(r)),deadline:new Date(k+"T00:00:00").toISOString(),description:R.trim(),documents:A.split(",").map(e=>e.trim()).filter(Boolean)};u(!0);try{await (0,n.hi)(`${l}/${e.id}`,{method:"PUT",json:i,expectJson:!1}),t(),a()}catch(e){m(e?.message||"Failed to update tender")}finally{u(!1)}}return(0,s.jsxs)("div",{className:"fixed inset-0 z-[100]",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:t}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"w-full max-w-3xl h-[90vh] rounded-2xl bg-white shadow-2xl flex flex-col",children:[(0,s.jsxs)("div",{className:"shrink-0 px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"Edit Tender"}),s.jsx("button",{onClick:t,className:"rounded-lg border border-neutral-300 px-3 py-1.5 text-sm hover:bg-neutral-50",children:"Close"})]}),(0,s.jsxs)("form",{onSubmit:L,className:"grow overflow-y-auto px-6 py-5 space-y-4",children:[x&&s.jsx("div",{className:"rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-700",children:x}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Title"}),s.jsx("input",{value:h,onChange:e=>g(e.target.value),className:"rounded-xl border px-3 py-2"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Owner"}),s.jsx("input",{value:j,onChange:e=>b(e.target.value),className:"rounded-xl border px-3 py-2"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Sector"}),(0,s.jsxs)("select",{value:v,onChange:e=>N(e.target.value),className:"rounded-xl border px-3 py-2",children:[s.jsx("option",{value:"OIL_GAS",children:"OIL_GAS"}),s.jsx("option",{value:"RENEWABLE_ENERGY",children:"RENEWABLE_ENERGY"}),s.jsx("option",{value:"UTILITIES",children:"UTILITIES"}),s.jsx("option",{value:"ENGINEERING",children:"ENGINEERING"})]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Status"}),(0,s.jsxs)("select",{value:f,onChange:e=>y(e.target.value),className:"rounded-xl border px-3 py-2",children:[s.jsx("option",{value:"OPEN",children:"OPEN"}),s.jsx("option",{value:"PREQUALIFICATION",children:"PREQUALIFICATION"}),s.jsx("option",{value:"CLOSED",children:"CLOSED"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Contract"}),s.jsx("select",{value:S,onChange:e=>I(e.target.value),className:"rounded-xl border px-3 py-2",children:i.map(e=>s.jsx("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Deadline"}),s.jsx("input",{type:"date",value:k,onChange:e=>P(e.target.value),className:"rounded-xl border px-3 py-2"})]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Location"}),s.jsx("input",{value:E,onChange:e=>C(e.target.value),className:"rounded-xl border px-3 py-2",placeholder:"Kab/Kota, Provinsi"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Nilai Proyek (IDR)"}),s.jsx("input",{value:D,onChange:e=>w(p(e.target.value)),className:"rounded-xl border px-3 py-2",inputMode:"numeric"}),s.jsx("p",{className:"text-xs text-neutral-500",children:"Tersimpan sebagai IDR (tanpa konversi)."})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Description"}),s.jsx("textarea",{value:R,onChange:e=>T(e.target.value),className:"min-h-32 rounded-xl border px-3 py-2"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Documents (comma separated)"}),s.jsx("input",{value:A,onChange:e=>O(e.target.value),className:"rounded-xl border px-3 py-2"})]})]}),(0,s.jsxs)("div",{className:"shrink-0 px-6 py-4 border-t border-neutral-200 flex items-center justify-end gap-3",children:[s.jsx("button",{onClick:t,className:"rounded-xl border px-4 py-2 text-sm hover:bg-neutral-50",children:"Cancel"}),s.jsx("button",{onClick:L,disabled:c,className:"rounded-xl bg-neutral-900 px-4 py-2 text-sm font-semibold text-white hover:opacity-90 disabled:opacity-60",children:c?"Saving…":"Save changes"})]})]})})]})}function x({children:e,className:t=""}){return s.jsx("th",{className:`px-3 py-2 text-xs uppercase tracking-wide text-neutral-500 ${t}`,children:e})}function m({children:e,className:t=""}){return s.jsx("td",{className:`px-3 py-2 align-top ${t}`,children:e})}function p(e){let t=(e||"").replace(/[^\d]/g,"");if(!t)return"";let a=[];for(let e=t.length;e>0;e-=3){let s=Math.max(0,e-3);a.unshift(t.slice(s,e))}return a.join(".")}},13686:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(45347).createProxy)(String.raw`D:\tugas\magang\frontend-arkwork1\src\app\admin\(protected)\tenders\page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[285,59,785,342],()=>a(67242));module.exports=s})();