(()=>{var e={};e.id=411,e.ids=[411],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},49411:e=>{"use strict";e.exports=require("node:path")},97742:e=>{"use strict";e.exports=require("node:process")},41041:e=>{"use strict";e.exports=require("node:url")},54529:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d}),a(15586),a(76630),a(55512),a(90996);var r=a(30170),s=a(45002),o=a(83876),n=a.n(o),l=a(66299),i={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);a.d(t,i);let d=["",{children:["admin",{children:["(protected)",{children:["employer-jobs",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,15586)),"D:\\tugas\\magang\\frontend-arkwork1\\src\\app\\admin\\(protected)\\employer-jobs\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,76630)),"D:\\tugas\\magang\\frontend-arkwork1\\src\\app\\admin\\(protected)\\layout.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,55512)),"D:\\tugas\\magang\\frontend-arkwork1\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,90996,23)),"next/dist/client/components/not-found-error"]}],c=["D:\\tugas\\magang\\frontend-arkwork1\\src\\app\\admin\\(protected)\\employer-jobs\\page.tsx"],p="/admin/(protected)/employer-jobs/page",m={require:a,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/admin/(protected)/employer-jobs/page",pathname:"/admin/employer-jobs",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},79300:(e,t,a)=>{Promise.resolve().then(a.bind(a,85763))},85763:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(97247),s=a(28964),o=a(34178);let n=process.env.NEXT_PUBLIC_API_BASE||process.env.NEXT_PUBLIC_API_URL||"",l=e=>`${(n||"").replace(/\/+$/,"")}${e}`;function i(){let e=(0,o.useSearchParams)().get("focus"),[t,a]=(0,s.useState)([]),[n,i]=(0,s.useState)(""),[c,p]=(0,s.useState)(!1),[m,u]=(0,s.useState)({}),[x,h]=(0,s.useState)(!1),[b,g]=(0,s.useState)(null),y=(0,s.useRef)({}),f=(e,t)=>u(a=>({...a,[e]:t}));async function j(e){let t=await e.text().catch(()=>"");return`${e.url} → ${e.status} ${e.statusText}${t?" — "+t:""}`}async function k(e,t){try{let a=await fetch(e,{credentials:"include",...t});if(a.ok)return{ok:!0,r:a,url:e};return{ok:!1,r:a,url:e,msg:await j(a)}}catch(t){return{ok:!1,r:null,url:e,msg:`${e} → ${t?.message||"network error"}`}}}async function v(e){for(let t of e)try{let e=await t();if(e.ok)return e}catch{}throw Error("Semua kandidat endpoint gagal")}let N=async()=>{p(!0);try{let e=await v([()=>fetch(l("/api/admin/employer-jobs"),{cache:"no-store",credentials:"include"}),()=>fetch(l("/api/employer-jobs"),{cache:"no-store",credentials:"include"}),()=>fetch(l("/api/jobs"),{cache:"no-store",credentials:"include"})]),t=await e.json().catch(()=>({})),r=(Array.isArray(t)?t:Array.isArray(t?.data)?t.data:[]).map(e=>{let t=e.logoUrl??e.employer?.profile?.logoUrl??e.companyLogo??null,a=e.company??e.employer?.displayName??null;return{id:String(e.id??e.jobId??""),title:e.title??e.jobTitle??"-",company:a,employer:e.employer??null,logoUrl:t,location:e.location??e.city??"—",employment:e.employment??e.type??e.employmentType??"—",postedAt:e.postedAt??e.createdAt??e.created_at??null,isActive:"boolean"==typeof e.isActive?e.isActive:"active"===String(e.status??e.state??"").toLowerCase()||void 0,status:e.status??e.state??null}}).filter(e=>e.id);a(r)}finally{p(!1)}},w=e=>"boolean"==typeof e.isActive?e.isActive:"active"===(e.status??"").toLowerCase(),C=(e,t)=>a(a=>a.map(a=>a.id===e?{...a,isActive:t,status:t?"active":"inactive"}:a)),A=async e=>{if(confirm("Aktifkan job ini?")){f(e,!0);try{let t=[()=>k(l(`/api/employer-jobs/${e}`),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"ACTIVE"})}),()=>k(l(`/api/jobs/${e}`),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"ACTIVE"})}),()=>k(l(`/api/admin/employer-jobs/${e}`),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"ACTIVE"})}),()=>k(l(`/api/employer-jobs/${e}/activate`),{method:"POST"})],a=[];for(let r of t){let t=await r();if(t.ok){C(e,!0);return}a.push(t.msg)}alert(`Gagal mengaktifkan job.

${a.join("\n")}`)}finally{f(e,!1)}}},P=async e=>{if(confirm("Nonaktifkan job ini?")){f(e,!0);try{let t=[()=>k(l(`/api/employer-jobs/${e}`),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"INACTIVE"})}),()=>k(l(`/api/employer-jobs/${e}/deactivate`),{method:"POST"}),()=>k(l(`/api/jobs/${e}`),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"INACTIVE"})}),()=>k(l(`/api/admin/employer-jobs/${e}`),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"INACTIVE"})})],a=[];for(let r of t){let t=await r();if(t.ok){C(e,!1);return}a.push(t.msg)}alert(`Gagal menonaktifkan job.

${a.join("\n")}`)}finally{f(e,!1)}}};async function E(e){try{let t=await fetch(l(`/api/admin/reports/by-job/${encodeURIComponent(e)}`),{method:"DELETE",credentials:"include"});if(!t.ok){let e=await t.text().catch(()=>"");return console.warn("deleteReportsForJob failed:",t.status,e),!1}return!0}catch(e){return console.error("deleteReportsForJob error",e),!1}}let T=async e=>{if(confirm("Delete job ini?")){f(e,!0);try{let t=[()=>k(l(`/api/employer-jobs/${e}`),{method:"DELETE"}),()=>k(l(`/api/employer-jobs/${e}/soft-delete`),{method:"POST"}),()=>k(l(`/api/jobs/${e}?soft=1`),{method:"DELETE"}),()=>k(l(`/api/admin/employer-jobs/${e}`),{method:"DELETE"})],r=[];for(let s of t){let t=await s();if(t.ok){let t=await E(e);try{localStorage.setItem("ark:report:ping",String(Date.now()))}catch{}a(t=>t.filter(t=>t.id!==e)),b?.id===e&&h(!1),t||alert("Job dihapus, namun gagal menghapus laporan terkait (cek console).");return}r.push(t.msg)}alert(`Gagal delete job.

${r.join("\n")}`)}finally{f(e,!1)}}},$=async e=>{if(confirm("PERINGATAN: Hapus permanen. Lanjut?")){f(e,!0);try{let t=[()=>k(l(`/api/employer-jobs/${e}`),{method:"DELETE"}),()=>k(l(`/api/jobs/${e}`),{method:"DELETE"}),()=>k(l(`/api/admin/employer-jobs/${e}?mode=hard`),{method:"DELETE"})],r=[];for(let s of t){let t=await s();if(t.ok){let t=await E(e);try{localStorage.setItem("ark:report:ping",String(Date.now()))}catch{}a(t=>t.filter(t=>t.id!==e)),t||alert("Job dihapus, namun gagal menghapus laporan terkait (cek console).");return}r.push(t.msg)}alert(`Gagal hard delete job.

${r.join("\n")}
Catatan: kalau DB menolak karena relasi, gunakan Soft Delete.`)}finally{f(e,!1)}}},S=(0,s.useMemo)(()=>{let e=n.trim().toLowerCase();return e?t.filter(t=>[t.title,t.company,t.employer?.displayName,t.location,t.employment,t.status].filter(Boolean).some(t=>String(t).toLowerCase().includes(e))):t},[t,n]),D=(0,s.useMemo)(()=>e?S.filter(t=>t.id===e):S,[S,e]);return(0,r.jsxs)("main",{className:"mx-auto max-w-7xl p-4",children:[r.jsx("style",{children:`
        .ark-pulse{outline:3px solid rgba(59,130,246,.8);outline-offset:2px;animation:arkPulse 1.2s ease-in-out 2;background:#eff6ff}
        @keyframes arkPulse{0%{background:#eff6ff}50%{background:#dbeafe}100%{background:transparent}}
      `}),(0,r.jsxs)("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-2",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-xl font-semibold",children:"Admin \xb7 Moderasi Job Employer"}),r.jsx("p",{className:"text-sm text-neutral-600",children:"Aktifkan/nonaktifkan, atau delete postingan job."})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("input",{value:n,onChange:e=>i(e.target.value),placeholder:"Cari judul/perusahaan/lokasi…",className:"w-72 rounded-xl border border-neutral-300 bg-white px-3 py-2 text-sm outline-none focus:border-neutral-400"}),r.jsx("button",{onClick:N,className:"rounded-xl border px-3 py-2 hover:bg-gray-50",children:c?"Muat…":"Muat ulang"})]})]}),0===D.length?(0,r.jsxs)("div",{className:"rounded-2xl border border-dashed border-neutral-300 bg-white p-10 text-center",children:[r.jsx("div",{className:"mx-auto mb-3 h-12 w-12 rounded-2xl bg-neutral-100 grid place-items-center",children:(0,r.jsxs)("svg",{className:"h-6 w-6 text-neutral-600",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("circle",{cx:"11",cy:"11",r:"7",stroke:"currentColor",strokeWidth:"2"}),r.jsx("path",{d:"M20 20l-3.5-3.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),r.jsx("h3",{className:"font-semibold text-neutral-900",children:"Tidak ada data"}),r.jsx("p",{className:"mt-1 text-sm text-neutral-600",children:"Coba muat ulang atau ubah kata kunci pencarian."})]}):r.jsx("section",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:D.map(e=>{let t=w(e),a=!!m[e.id];return r.jsx("article",{ref:t=>{y.current[e.id]=t},onClick:()=>{g(e),h(!0)},className:"group cursor-pointer rounded-2xl border border-neutral-200 bg-white p-4 shadow-sm hover:shadow-md transition",children:(0,r.jsxs)("div",{className:"flex gap-4",children:[r.jsx("div",{className:"h-12 w-12 shrink-0 rounded-xl bg-gradient-to-tr from-blue-600 via-blue-500 to-amber-400 grid place-items-center overflow-hidden text-white text-sm font-bold",children:e.logoUrl?r.jsx("img",{alt:e.company||"logo",src:e.logoUrl,className:"h-full w-full object-cover"}):r.jsx("span",{className:"select-none",children:(e.company||"AW").slice(0,2).toUpperCase()})}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[r.jsx("h3",{className:"truncate text-base font-semibold text-neutral-900",children:e.title}),r.jsx("p",{className:"truncate text-sm text-neutral-600",children:e.company||"Perusahaan"})]}),r.jsx("span",{className:`rounded-lg px-2 py-1 text-xs ${t?"bg-emerald-50 text-emerald-700 border border-emerald-300":"bg-amber-50 text-amber-700 border border-amber-300"}`,title:"Status",children:t?"active":"inactive"})]}),(0,r.jsxs)("div",{className:"mt-3 grid grid-cols-2 sm:grid-cols-4 gap-2 text-[13px]",children:[(0,r.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-lg border border-neutral-200 bg-neutral-50 px-2 py-1",children:[(0,r.jsxs)("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("path",{d:"M12 22s7-4.5 7-11a7 7 0 10-14 0c0 6.5 7 11 7 11z",stroke:"currentColor",strokeWidth:"2"}),r.jsx("circle",{cx:"12",cy:"11",r:"2.5",stroke:"currentColor",strokeWidth:"2"})]}),r.jsx("span",{className:"truncate",children:e.location??"—"})]}),(0,r.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-lg border border-neutral-200 bg-neutral-50 px-2 py-1",children:[(0,r.jsxs)("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("rect",{x:"3",y:"7",width:"18",height:"13",rx:"2",stroke:"currentColor",strokeWidth:"2"}),r.jsx("path",{d:"M9 7V5a2 2 0 012-2h2a2 2 0 012 2v2",stroke:"currentColor",strokeWidth:"2"})]}),r.jsx("span",{className:"truncate",children:e.employment??"—"})]}),(0,r.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-lg border border-neutral-200 bg-neutral-50 px-2 py-1",children:[r.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M12 3l8 4-8 4-8-4 8-4z",stroke:"currentColor",strokeWidth:"2"})}),r.jsx("span",{className:"truncate",children:e.employer?.id?`EMP ${e.employer.id.slice(0,6)}…`:"—"})]}),(0,r.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-lg border border-neutral-200 bg-neutral-50 px-2 py-1",children:[(0,r.jsxs)("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("rect",{x:"3",y:"5",width:"18",height:"16",rx:"2",stroke:"currentColor",strokeWidth:"2"}),r.jsx("path",{d:"M8 3v4M16 3v4M3 11h18",stroke:"currentColor",strokeWidth:"2"})]}),r.jsx("span",{className:"truncate",children:e.postedAt?new Date(e.postedAt).toLocaleDateString():"—"})]})]}),(0,r.jsxs)("div",{className:"mt-3 flex flex-wrap items-center justify-end gap-2",children:[r.jsx("button",{disabled:a||t,onClick:t=>{t.stopPropagation(),A(e.id)},className:"rounded-xl border px-2.5 py-1 text-sm hover:bg-gray-50 disabled:opacity-50",children:"Aktifkan"}),r.jsx("button",{disabled:a||!t,onClick:t=>{t.stopPropagation(),P(e.id)},className:"rounded-xl border px-2.5 py-1 text-sm hover:bg-gray-50 disabled:opacity-50",children:"Nonaktifkan"}),r.jsx("button",{disabled:a,onClick:t=>{t.stopPropagation(),T(e.id)},className:"rounded-xl border px-2.5 py-1 text-sm text-red-600 hover:bg-red-50 disabled:opacity-50",children:"Delete"}),r.jsx("button",{disabled:a,onClick:t=>{t.stopPropagation(),$(e.id)},className:"rounded-xl border px-2.5 py-1 text-sm text-red-700 hover:bg-red-100 disabled:opacity-50",title:"Hapus permanen",children:"Hard Delete"})]})]})]})},e.id)})}),x&&b&&r.jsx(d,{job:b,onClose:()=>h(!1),onActivate:()=>A(b.id),onDeactivate:()=>P(b.id),onSoftDelete:()=>T(b.id),busy:!!m[b.id]})]})}function d({job:e,busy:t,onClose:a,onActivate:s,onDeactivate:o,onSoftDelete:n}){let l="boolean"==typeof e.isActive?e.isActive:"active"===(e.status??"").toLowerCase();return(0,r.jsxs)("div",{className:"fixed inset-0 z-[100]","aria-modal":!0,role:"dialog",children:[r.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:a}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"w-full max-w-lg rounded-2xl bg-white shadow-xl overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-5 py-4 border-b border-neutral-200 flex items-center gap-3",children:[r.jsx("div",{className:"h-12 w-12 rounded-xl bg-gradient-to-tr from-blue-600 via-blue-500 to-amber-400 grid place-items-center overflow-hidden text-white text-sm font-bold",children:e.logoUrl?r.jsx("img",{alt:e.company||"logo",src:e.logoUrl,className:"h-full w-full object-cover"}):r.jsx("span",{className:"select-none",children:(e.company||"AW").slice(0,2).toUpperCase()})}),(0,r.jsxs)("div",{className:"min-w-0",children:[r.jsx("div",{className:"text-base font-semibold text-neutral-900 truncate",children:e.title}),r.jsx("div",{className:"text-sm text-neutral-600 truncate",children:e.company||"Perusahaan"})]}),r.jsx("span",{className:`ml-auto rounded-lg px-2 py-1 text-xs ${l?"bg-emerald-50 text-emerald-700 border border-emerald-300":"bg-amber-50 text-amber-700 border border-amber-300"}`,children:l?"active":"inactive"})]}),(0,r.jsxs)("div",{className:"px-5 py-4 space-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-xl border border-neutral-200 bg-neutral-50 px-3 py-2",children:[r.jsx("span",{className:"text-xs uppercase tracking-wide text-neutral-600",children:"Lokasi"}),r.jsx("span",{className:"text-sm font-medium text-neutral-900",children:e.location??"—"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-xl border border-neutral-200 bg-neutral-50 px-3 py-2",children:[r.jsx("span",{className:"text-xs uppercase tracking-wide text-neutral-600",children:"Tipe/Kontrak"}),r.jsx("span",{className:"text-sm font-medium text-neutral-900",children:e.employment??"—"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-xl border border-neutral-200 bg-neutral-50 px-3 py-2",children:[r.jsx("span",{className:"text-xs uppercase tracking-wide text-neutral-600",children:"Employer ID"}),r.jsx("span",{className:"text-sm font-medium text-neutral-900",children:e.employer?.id??"—"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-xl border border-neutral-200 bg-neutral-50 px-3 py-2",children:[r.jsx("span",{className:"text-xs uppercase tracking-wide text-neutral-600",children:"Dibuat"}),r.jsx("span",{className:"text-sm font-medium text-neutral-900",children:e.postedAt?new Date(e.postedAt).toLocaleDateString():"—"})]})]}),(0,r.jsxs)("div",{className:"px-5 py-4 border-t border-neutral-200 grid grid-cols-2 gap-2",children:[r.jsx("button",{onClick:a,className:"rounded-xl border px-3 py-2 text-sm hover:bg-gray-50",children:"Tutup"}),(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[r.jsx("button",{disabled:t||l,onClick:s,className:"rounded-xl border px-2.5 py-1 text-sm hover:bg-gray-50 disabled:opacity-50",children:"Aktifkan"}),r.jsx("button",{disabled:t||!l,onClick:o,className:"rounded-xl border px-2.5 py-1 text-sm hover:bg-gray-50 disabled:opacity-50",children:"Nonaktifkan"}),r.jsx("button",{disabled:t,onClick:n,className:"rounded-xl border px-2.5 py-1 text-sm text-red-600 hover:bg-red-50 disabled:opacity-50",children:"Delete"})]})]})]})})]})}},15586:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(45347).createProxy)(String.raw`D:\tugas\magang\frontend-arkwork1\src\app\admin\(protected)\employer-jobs\page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[285,59,785,342],()=>a(54529));module.exports=r})();