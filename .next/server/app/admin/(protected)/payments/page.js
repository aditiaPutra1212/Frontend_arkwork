(()=>{var e={};e.id=81,e.ids=[81],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},49411:e=>{"use strict";e.exports=require("node:path")},97742:e=>{"use strict";e.exports=require("node:process")},41041:e=>{"use strict";e.exports=require("node:url")},88006:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>o}),s(87547),s(76630),s(55512),s(90996);var a=s(30170),l=s(45002),r=s(83876),n=s.n(r),d=s(66299),i={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>d[e]);s.d(t,i);let o=["",{children:["admin",{children:["(protected)",{children:["payments",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,87547)),"D:\\tugas\\magang\\frontend-arkwork1\\src\\app\\admin\\(protected)\\payments\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,76630)),"D:\\tugas\\magang\\frontend-arkwork1\\src\\app\\admin\\(protected)\\layout.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,55512)),"D:\\tugas\\magang\\frontend-arkwork1\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,90996,23)),"next/dist/client/components/not-found-error"]}],c=["D:\\tugas\\magang\\frontend-arkwork1\\src\\app\\admin\\(protected)\\payments\\page.tsx"],x="/admin/(protected)/payments/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/admin/(protected)/payments/page",pathname:"/admin/payments",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},87481:(e,t,s)=>{Promise.resolve().then(s.bind(s,2057))},2057:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(97247),l=s(28964),r=s(90002);let n=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0}).format(e);function d(...e){return e.filter(Boolean).join(" ")}function i({children:e,className:t=""}){return a.jsx("th",{className:`px-4 py-3 text-left text-xs font-semibold ${t}`,children:e})}function o({children:e,className:t=""}){return a.jsx("td",{className:`px-4 py-3 align-top ${t}`,children:e})}function c({label:e,children:t}){return(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[a.jsx("div",{className:"col-span-1 text-slate-500",children:e}),a.jsx("div",{className:"col-span-2 font-medium text-slate-800 break-all",children:t})]})}let x=process.env.NEXT_PUBLIC_MIDTRANS_CLIENT_KEY??"",m={settlement:"bg-emerald-100 text-emerald-700",capture:"bg-emerald-100 text-emerald-700",pending:"bg-amber-100 text-amber-700",deny:"bg-rose-100 text-rose-700",cancel:"bg-rose-100 text-rose-700",expire:"bg-slate-200 text-slate-700",refund:"bg-violet-100 text-violet-700",failure:"bg-rose-100 text-rose-700"};function u(){let[e,t]=(0,l.useState)("inbox");return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6 flex flex-wrap items-center justify-between gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Payments (Midtrans)"}),a.jsx("p",{className:"text-sm text-slate-600",children:"Kelola pembayaran perusahaan (inbox), dan opsional uji coba Snap pada tab Manual Checkout."})]}),(0,a.jsxs)("div",{className:"rounded-xl border border-slate-200 p-1",children:[a.jsx("button",{onClick:()=>t("inbox"),className:d("rounded-lg px-3 py-1.5 text-sm","inbox"===e?"bg-slate-900 text-white":"text-slate-700"),children:"Inbox"}),a.jsx("button",{onClick:()=>t("checkout"),className:d("rounded-lg px-3 py-1.5 text-sm","checkout"===e?"bg-slate-900 text-white":"text-slate-700"),children:"Manual Checkout (Test)"})]})]}),"inbox"===e?a.jsx(p,{}):a.jsx(h,{})]})}function p(){let[e,t]=(0,l.useState)([]),[s,d]=(0,l.useState)(null),[c,x]=(0,l.useState)(!0),[u,p]=(0,l.useState)(null),[h,b]=(0,l.useState)("");async function g({cursor:e}={}){x(!0),p(null);try{let s=new URLSearchParams;e&&s.set("cursor",e),h&&s.set("status",h);let a=await (0,r.hi)(`/api/payments?${s.toString()}`);e?t(e=>[...e,...a.items]):t(a.items),d(a.nextCursor)}catch(e){p(e?.message||"Gagal memuat pembayaran")}finally{x(!1)}}return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center gap-2",children:[(0,a.jsxs)("select",{value:h,onChange:e=>b(e.target.value),className:"rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm",title:"Filter status",children:[a.jsx("option",{value:"",children:"Semua status"}),a.jsx("option",{value:"settlement",children:"Settlement"}),a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"capture",children:"Capture"}),a.jsx("option",{value:"expire",children:"Expire"}),a.jsx("option",{value:"cancel",children:"Cancel"}),a.jsx("option",{value:"deny",children:"Deny"}),a.jsx("option",{value:"refund",children:"Refund"}),a.jsx("option",{value:"failure",children:"Failure"})]}),a.jsx("button",{onClick:()=>g(),className:"rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm hover:bg-slate-50",children:"Refresh"})]}),u&&a.jsx("div",{className:"mb-4 rounded-xl border border-rose-200 bg-rose-50 px-4 py-2 text-rose-700",children:u}),a.jsx("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white",children:(0,a.jsxs)("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-slate-50 text-slate-600",children:(0,a.jsxs)("tr",{children:[a.jsx(i,{children:"Waktu"}),a.jsx(i,{children:"Perusahaan"}),a.jsx(i,{children:"Paket"}),a.jsx(i,{className:"text-right",children:"Jumlah"}),a.jsx(i,{children:"Status"}),a.jsx(i,{children:"Metode"}),a.jsx(i,{children:"Order ID"})]})}),a.jsx("tbody",{children:c&&0===e.length?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-slate-500",colSpan:7,children:"Memuat…"})}):0===e.length?a.jsx("tr",{children:a.jsx("td",{className:"p-6 text-slate-500",colSpan:7,children:"Belum ada pembayaran."})}):e.map(e=>(0,a.jsxs)("tr",{className:"border-t border-slate-100",children:[a.jsx(o,{children:new Date(e.createdAt).toLocaleString("id-ID")}),(0,a.jsxs)(o,{children:[a.jsx("div",{className:"font-medium text-slate-900",children:e.employer?.displayName||e.employer?.legalName||"—"}),a.jsx("div",{className:"text-xs text-slate-500",children:e.employer?.slug||"—"})]}),(0,a.jsxs)(o,{children:[a.jsx("div",{className:"text-slate-900",children:e.plan?.name||"—"}),(0,a.jsxs)("div",{className:"text-xs text-slate-500",children:[e.plan?.slug||"—"," ",e.plan?.interval?`• /${e.plan.interval}`:""]})]}),a.jsx(o,{className:"text-right font-semibold",children:n(e.grossAmount)}),a.jsx(o,{children:a.jsx("span",{className:`inline-flex rounded-full px-2 py-0.5 text-xs ${m[e.status]||"bg-slate-100 text-slate-700"}`,children:e.status})}),a.jsx(o,{children:e.method||"—"}),(0,a.jsxs)(o,{children:[a.jsx("div",{className:"font-mono text-xs",children:e.orderId}),e.transactionId&&a.jsx("div",{className:"font-mono text-[11px] text-slate-500",children:e.transactionId})]})]},e.id))})]})}),(0,a.jsxs)("div",{className:"mt-4 flex justify-between",children:[(0,a.jsxs)("span",{className:"text-xs text-slate-500",children:[e.length," item",1!==e.length?"s":"",h?` • status: ${h}`:""]}),s?a.jsx("button",{onClick:()=>g({cursor:s}),className:"rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm hover:bg-slate-50",disabled:c,children:c?"Memuat…":"Muat lebih banyak"}):a.jsx("span",{className:"text-xs text-slate-400",children:"— selesai —"})]})]})}function h(){let[e,t]=(0,l.useState)([]),[s,d]=(0,l.useState)(!0),[i,o]=(0,l.useState)(null),[m,u]=(0,l.useState)(""),[p,h]=(0,l.useState)(""),[b,g]=(0,l.useState)(""),[j,v]=(0,l.useState)(""),[N,y]=(0,l.useState)(""),[f,k]=(0,l.useState)(""),[w,S]=(0,l.useState)(!1),[_,P]=(0,l.useState)(null),[C,I]=(0,l.useState)(""),D=(0,l.useMemo)(()=>e.find(e=>e.id===m),[e,m]);async function E(){if(!m||!b){o("Plan dan email wajib diisi.");return}o(null),S(!0);try{let e=await (0,r.hi)("/api/payments/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:m,employerId:p||void 0,customer:{email:b,first_name:j,last_name:N,phone:f}})});P(e),window.snap?.pay?window.snap.pay(e.token,{onSuccess:()=>I("settlement"),onPending:()=>I("pending"),onError:()=>I("error"),onClose:()=>I(e=>e||"closed")}):window.open(e.redirect_url,"_blank","noopener,noreferrer")}catch(e){o(e?.message||"Gagal memulai pembayaran")}finally{S(!1)}}return(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,a.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[a.jsx("h2",{className:"mb-3 text-sm font-semibold text-slate-900",children:"Data Transaksi (Test)"}),i&&a.jsx("div",{className:"mb-3 rounded-xl border border-rose-200 bg-rose-50 px-4 py-2 text-rose-700",children:i}),s?a.jsx("div",{className:"text-slate-500",children:"Loading…"}):(0,a.jsxs)("div",{className:"grid gap-3",children:[(0,a.jsxs)("label",{className:"block text-sm",children:[a.jsx("div",{className:"mb-1 text-slate-600",children:"Paket"}),a.jsx("select",{value:m,onChange:e=>u(e.target.value),className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",children:e.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," — ",n(e.amount)," / ",e.interval]},e.id))})]}),(0,a.jsxs)("label",{className:"block text-sm",children:[a.jsx("div",{className:"mb-1 text-slate-600",children:"Employer ID (opsional)"}),a.jsx("input",{value:p,onChange:e=>h(e.target.value),placeholder:"uuid employer (jika ada)",className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm"})]}),(0,a.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,a.jsxs)("label",{className:"block text-sm",children:[a.jsx("div",{className:"mb-1 text-slate-600",children:"Email Customer"}),a.jsx("input",{type:"email",value:b,onChange:e=>g(e.target.value),className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",placeholder:"customer@email.com"})]}),(0,a.jsxs)("label",{className:"block text-sm",children:[a.jsx("div",{className:"mb-1 text-slate-600",children:"Telepon (opsional)"}),a.jsx("input",{value:f,onChange:e=>k(e.target.value),className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",placeholder:"08xxxxxxxxxx"})]})]}),(0,a.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,a.jsxs)("label",{className:"block text-sm",children:[a.jsx("div",{className:"mb-1 text-slate-600",children:"Nama Depan"}),a.jsx("input",{value:j,onChange:e=>v(e.target.value),className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm"})]}),(0,a.jsxs)("label",{className:"block text-sm",children:[a.jsx("div",{className:"mb-1 text-slate-600",children:"Nama Belakang"}),a.jsx("input",{value:N,onChange:e=>y(e.target.value),className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm"})]})]}),a.jsx("button",{onClick:E,disabled:w||!m||!b,className:"mt-2 inline-flex w-full items-center justify-center rounded-xl bg-blue-600 px-4 py-2.5 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",children:w?"Membuat transaksi…":"Buat Pembayaran"}),!x&&(0,a.jsxs)("p",{className:"text-xs text-amber-700 bg-amber-50 border border-amber-200 rounded-lg px-3 py-2",children:[a.jsx("b",{children:"Warning:"})," ",a.jsx("code",{children:"NEXT_PUBLIC_MIDTRANS_CLIENT_KEY"})," belum diset. Snap tidak bisa dibuka, sistem akan membuka ",a.jsx("em",{children:"redirect_url"})," saja."]})]})]}),(0,a.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[a.jsx("h2",{className:"mb-3 text-sm font-semibold text-slate-900",children:"Ringkasan"}),(0,a.jsxs)("dl",{className:"space-y-2 text-sm",children:[a.jsx(c,{label:"Paket",children:D?.name??"-"}),a.jsx(c,{label:"Harga",children:D?n(D.amount):"-"}),a.jsx(c,{label:"Interval",children:D?.interval??"-"}),a.jsx(c,{label:"Email",children:b||"-"}),a.jsx(c,{label:"Employer ID",children:p||"-"})]}),_&&(0,a.jsxs)("div",{className:"mt-5 rounded-xl border border-blue-200 bg-blue-50 p-3 text-sm",children:[a.jsx("div",{className:"font-semibold text-blue-900",children:"Transaksi dibuat"}),(0,a.jsxs)("div",{className:"mt-1 text-blue-800",children:["Order ID: ",a.jsx("code",{className:"font-mono",children:_.orderId})]}),a.jsx("div",{className:"mt-1",children:a.jsx("button",{onClick:()=>window.snap?.pay?window.snap.pay(_.token):window.open(_.redirect_url,"_blank","noopener,noreferrer"),className:"mt-2 rounded-lg bg-blue-600 px-3 py-1.5 text-white hover:bg-blue-700",children:"Buka Snap"})})]}),C&&(0,a.jsxs)("div",{className:"mt-4 rounded-xl border px-3 py-2 text-sm",style:{borderColor:"#cbd5e1",background:"#f8fafc"},children:["Status transaksi: ",a.jsx("b",{children:C})]})]})]})}},87547:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(45347).createProxy)(String.raw`D:\tugas\magang\frontend-arkwork1\src\app\admin\(protected)\payments\page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[285,59,785,342],()=>s(88006));module.exports=a})();