(()=>{var e={};e.id=178,e.ids=[178],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},49411:e=>{"use strict";e.exports=require("node:path")},97742:e=>{"use strict";e.exports=require("node:process")},41041:e=>{"use strict";e.exports=require("node:url")},1183:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),a(48445),a(55512),a(90996);var r=a(30170),s=a(45002),n=a(83876),l=a.n(n),i=a(66299),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);a.d(t,o);let d=["",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,48445)),"D:\\tugas\\magang\\frontend-arkwork1\\src\\app\\profile\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,55512)),"D:\\tugas\\magang\\frontend-arkwork1\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,90996,23)),"next/dist/client/components/not-found-error"]}],c=["D:\\tugas\\magang\\frontend-arkwork1\\src\\app\\profile\\page.tsx"],u="/profile/page",p={require:a,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/profile/page",pathname:"/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},28256:(e,t,a)=>{Promise.resolve().then(a.bind(a,96133))},96133:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var r=a(97247),s=a(28964),n=a(9317),l=a(26009),i=a(34178);let o="ark_users",d="ark_nav_avatar:";function c(){return new Promise((e,t)=>{let a=indexedDB.open("ark_db",2);a.onupgradeneeded=()=>{let e=a.result;e.objectStoreNames.contains("avatar_files")||e.createObjectStore("avatar_files")},a.onsuccess=()=>e(a.result),a.onerror=()=>t(a.error)})}async function u(e,t){let a=await c();await new Promise((r,s)=>{let n=a.transaction("avatar_files","readwrite");n.objectStore("avatar_files").put(t,e),n.oncomplete=()=>r(),n.onerror=()=>s(n.error)}),a.close()}async function p(e){let t=await c();await new Promise((a,r)=>{let s=t.transaction("avatar_files","readwrite");s.objectStore("avatar_files").delete(e),s.oncomplete=()=>a(),s.onerror=()=>r(s.error)}),t.close()}let x=()=>{try{return JSON.parse(localStorage.getItem(o)??"[]")}catch{return[]}},m=e=>localStorage.setItem(o,JSON.stringify(e));function h({children:e}){return r.jsx("label",{className:"mb-1.5 block text-sm font-medium text-neutral-800",children:e})}function g(e){let{className:t,...a}=e;return r.jsx("input",{...a,className:`w-full rounded-xl border border-neutral-300 bg-white px-3.5 py-2.5 text-sm text-neutral-900 placeholder-neutral-400 outline-none transition focus:border-neutral-900 ${t??""}`})}function f({toast:e,onClose:t}){if(!e)return null;let a="success"===e.type?"bg-green-50 text-green-800 border-green-200":"error"===e.type?"bg-red-50 text-red-700 border-red-200":"bg-neutral-50 text-neutral-700 border-neutral-200";return r.jsx("div",{className:`rounded-2xl border px-4 py-3 text-sm ${a}`,children:(0,r.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[r.jsx("span",{children:e.message}),r.jsx("button",{onClick:t,className:"text-xs opacity-70 hover:opacity-100",children:"✕"})]})})}async function v(e,t=160){let a=await new Promise((t,a)=>{let r=URL.createObjectURL(e),s=new Image;s.onload=()=>{URL.revokeObjectURL(r),t(s)},s.onerror=e=>a(e),s.src=r}),r=document.createElement("canvas"),s=t/Math.max(a.width,a.height);return r.width=Math.round(a.width*s),r.height=Math.round(a.height*s),r.getContext("2d").drawImage(a,0,0,r.width,r.height),r.toDataURL("image/jpeg",.85)}function b({value:e,onChange:t,labelProv:a="Provinsi",labelKab:n="Kabupaten/Kota",labelKec:l="Kecamatan"}){let[i,o]=(0,s.useState)([]),[d,c]=(0,s.useState)([]),[u,p]=(0,s.useState)([]),[x,m]=(0,s.useState)(null),[h,g]=(0,s.useState)(null),[f,v]=(0,s.useState)(null),b=({value:e,setValue:t,options:a,placeholder:s,disabled:n})=>(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("select",{value:e?.id||"",onChange:e=>{let r=e.target.value;t(a.find(e=>e.id===r)||null)},disabled:n,className:"w-full appearance-none rounded-xl border border-neutral-300 bg-white px-3.5 py-2.5 pr-10 text-sm outline-none focus:border-neutral-900 disabled:bg-neutral-100 disabled:text-neutral-500",children:[r.jsx("option",{value:"",children:s}),a.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]}),r.jsx("span",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-neutral-500",children:"▾"})]});return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"grid gap-3 sm:grid-cols-3",children:[(0,r.jsxs)("div",{children:[r.jsx("span",{className:"mb-1 block text-sm text-neutral-700",children:a}),r.jsx(b,{value:x,setValue:m,options:i,placeholder:"Pilih provinsi…"})]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"mb-1 block text-sm text-neutral-700",children:n}),r.jsx(b,{value:h,setValue:g,options:d,placeholder:"Pilih kab/kota…",disabled:!x})]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"mb-1 block text-sm text-neutral-700",children:l}),r.jsx(b,{value:f,setValue:v,options:u,placeholder:"Pilih kecamatan…",disabled:!h})]})]}),e&&(0,r.jsxs)("div",{className:"text-xs text-neutral-600",children:["Dipilih: ",r.jsx("span",{className:"font-medium",children:e})]}),r.jsx("div",{children:r.jsx("button",{type:"button",onClick:()=>{m(null),g(null),v(null),t("Remote")},className:"rounded-lg border border-neutral-300 px-3 py-1.5 text-xs text-neutral-700 hover:bg-neutral-50",children:"Pilih “Remote”"})})]})}function j(){let e=(0,l.T_)("profile"),{user:t}=(0,n.a)();(0,i.useRouter)();let a=t?.email??null,o=!a,[c,j]=(0,s.useState)(""),[w,y]=(0,s.useState)(""),[N,k]=(0,s.useState)(""),[S,P]=(0,s.useState)(null),[_,U]=(0,s.useState)(null),[R,C]=(0,s.useState)(!1),[L,E]=(0,s.useState)(!1),[O,I]=(0,s.useState)(null);async function q(e){if(a){if(!e.type.startsWith("image/")){I({type:"error",message:"File harus gambar (PNG/JPG/SVG)."});return}if(e.size/1048576>2){I({type:"error",message:"Ukuran foto maksimum 2MB"});return}E(!0);try{let t=`avatar:${a}`;await u(t,e),P({name:e.name,type:e.type,key:t});let r=URL.createObjectURL(e);U(e=>(e&&URL.revokeObjectURL(e),r));let s=await v(e,160);localStorage.setItem(d+a,s),window.dispatchEvent(new Event("ark:avatar-updated")),I({type:"success",message:"Foto profil diperbarui."})}catch{I({type:"error",message:"Gagal mengunggah foto."})}finally{E(!1)}}}async function G(){if(a)try{S?.key&&await p(S.key),U(e=>(e&&URL.revokeObjectURL(e),null)),P(null),localStorage.removeItem(d+a);let e=x(),t=e.findIndex(e=>e.email===a);t>=0&&(e[t].profile={...e[t].profile,photo:null},e[t].updatedAt=new Date().toISOString(),m(e)),window.dispatchEvent(new Event("ark:avatar-updated")),I({type:"success",message:"Foto profil dihapus."})}catch{I({type:"error",message:"Gagal menghapus foto."})}}return o?r.jsx("div",{className:"grid min-h-[60vh] place-items-center px-4",children:r.jsx("div",{className:"text-center",children:r.jsx("p",{className:"text-sm text-neutral-600",children:"Mengarahkan ke halaman masuk…"})})}):r.jsx("div",{className:"min-h-screen bg-neutral-50 py-10",children:(0,r.jsxs)("div",{className:"mx-auto max-w-4xl space-y-6 px-4 sm:px-6",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[r.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-neutral-900",children:e("title")||"Profil Saya"}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("button",{onClick:function(){if(a){C(!0);try{let t=x(),r=new Date().toISOString(),s=t.findIndex(e=>e.email===a),n={email:a,name:c,profile:{location:w,phone:N,photo:S,photoUrl:_??null},createdAt:s>=0?t[s].createdAt:r,updatedAt:r};s>=0?t[s]={...t[s],...n}:t.push(n),m(t),localStorage.setItem("ark_nav_name:"+a,c),window.dispatchEvent(new Event("ark:name-updated")),I({type:"success",message:e("toast.saved")||"Tersimpan."})}catch{I({type:"error",message:e("toast.failed")||"Gagal menyimpan."})}finally{C(!1)}}},disabled:R,className:"rounded-xl bg-neutral-900 px-5 py-2 text-sm font-medium text-white shadow-sm transition hover:bg-neutral-800 disabled:cursor-not-allowed disabled:opacity-60",children:R?e("actions.saving")||"Menyimpan...":e("actions.save")||"Simpan Profil"})})]}),r.jsx(f,{toast:O,onClose:()=>I(null)}),(0,r.jsxs)("div",{className:"rounded-2xl border border-neutral-200 bg-white p-6 shadow-sm",children:[(0,r.jsxs)("div",{className:"mb-6 flex items-center gap-5",children:[r.jsx("div",{className:"relative",children:r.jsx("div",{className:"h-20 w-20 overflow-hidden rounded-full border border-neutral-300 bg-neutral-100",children:_?r.jsx("img",{src:_,alt:"avatar",className:"h-full w-full object-cover"}):r.jsx("div",{className:"flex h-full w-full items-center justify-center text-sm text-neutral-500",children:(c?.[0]||a?.[0]||"U").toUpperCase()})})}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsxs)("label",{className:"inline-flex cursor-pointer items-center gap-2",children:[r.jsx("span",{className:"rounded-lg bg-neutral-900 px-3 py-1.5 text-xs font-medium text-white hover:bg-neutral-800",children:"Ubah Foto"}),r.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:async e=>{let t=e.target.files?.[0];t&&(await q(t),e.currentTarget.value="")}})]}),S&&r.jsx("button",{onClick:G,className:"rounded-lg border border-neutral-300 px-3 py-1.5 text-xs text-neutral-700 transition hover:bg-neutral-50",children:"Hapus Foto"}),L&&r.jsx("span",{className:"text-xs text-neutral-500",children:"Mengunggah..."})]})]}),(0,r.jsxs)("div",{className:"grid gap-5 md:grid-cols-2",children:[(0,r.jsxs)("div",{children:[r.jsx(h,{children:"Nama Lengkap"}),r.jsx(g,{value:c,onChange:e=>j(e.target.value),placeholder:"Nama lengkap"})]}),(0,r.jsxs)("div",{children:[r.jsx(h,{children:"Email"}),r.jsx(g,{readOnly:!0,value:a??"",className:"bg-neutral-100"})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[r.jsx(h,{children:"Lokasi"}),r.jsx(b,{value:w,onChange:y})]}),(0,r.jsxs)("div",{children:[r.jsx(h,{children:"Nomor HP"}),r.jsx(g,{value:N,onChange:e=>k(e.target.value),placeholder:"08xxxx"})]})]})]})]})})}},48445:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(45347).createProxy)(String.raw`D:\tugas\magang\frontend-arkwork1\src\app\profile\page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[285,59,785],()=>a(1183));module.exports=r})();